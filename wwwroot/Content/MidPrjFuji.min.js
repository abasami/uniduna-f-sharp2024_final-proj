(function(n){"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});n.WebSharper={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i of Object.getOwnPropertyNames(n))t[i]=n[i];return Object.setPrototypeOf(t,Object.getPrototypeOf(n)),t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},PrintObject:function(n){var t="{ ",i=!0;for(var r of Object.getOwnPropertyNames(n))i?i=!1:t+=", ",t+=r+" = "+n[r];return t+(i?"}":" }")},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return WebSharper.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:WebSharper.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},MarkResizable:function(n){return Object.defineProperty(n,"resizable",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},MarkReadOnly:function(n){return Object.defineProperty(n,"readonly",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};n.WebSharper.Runtime.OnLoad(function(){n.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});n.ignore=function(){};n.id=function(n){return n};n.fst=function(n){return n[0]};n.snd=function(n){return n[1]};n.trd=function(n){return n[2]};n.console||(n.console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore})})(self);
/* https://github.com/jonathantneal/closest */
(function(w,p){p=w.Element.prototype
if(!p.matches){p.matches=p.msMatchesSelector||function(s){var m=(this.document||this.ownerDocument).querySelectorAll(s);for(var i=0;m[i]&&m[i]!==e;++i);return!!m[i]}}
if(!p.closest){p.closest=function(s){var e=this;while(e&&e.nodeType==1){if(e.matches(s))return e;e=e.parentNode}return null}}})(self);
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca;b=a.MidPrjFuji=a.MidPrjFuji||{};c=b.Client=b.Client||{};d=a.WebSharper=a.WebSharper||{};e=d.Obj=d.Obj||{};f=d.UI=d.UI||{};g=f.Var$1=f.Var$1||{};h=f.ListModel=f.ListModel||{};i=c.Entry=c.Entry||{};j=d.Operators=d.Operators||{};k=f.Templating=f.Templating||{};l=k.Runtime=k.Runtime||{};m=l.Server=l.Server||{};n=m.TemplateInstance=m.TemplateInstance||{};o=d.Arrays=d.Arrays||{};p=m.ProviderBuilder=m.ProviderBuilder||{};q=f.Var=f.Var||{};r=m.Handler=m.Handler||{};s=a.Object;t=d.Unchecked=d.Unchecked||{};u=a.MidPrjFuji_Templates=a.MidPrjFuji_Templates||{};v=d.Seq=d.Seq||{};w=f.Doc=f.Doc||{};x=f.TemplateHole=f.TemplateHole||{};y=f.ConcreteVar=f.ConcreteVar||{};z=f.Snap=f.Snap||{};A=d.Numeric=d.Numeric||{};B=f.TemplateHoleModule=f.TemplateHoleModule||{};C=B.TextView=B.TextView||{};D=B.VarStr=B.VarStr||{};E=B.VarIntUnchecked=B.VarIntUnchecked||{};F=B.Elt=B.Elt||{};G=a.System=a.System||{};H=G.Guid=G.Guid||{};I=B.EventQ=B.EventQ||{};J=d.JavaScript=d.JavaScript||{};K=J.Pervasives=J.Pervasives||{};L=d.Strings=d.Strings||{};M=f.Client=f.Client||{};N=M.Templates=M.Templates||{};O=d.Enumerator=d.Enumerator||{};P=O.T=O.T||{};Q=f.Array=f.Array||{};R=B.Text=B.Text||{};S=f.Abbrev=f.Abbrev||{};T=S.Fresh=S.Fresh||{};U=f.Storage=f.Storage||{};V=f.View=f.View||{};W=d.Collections=d.Collections||{};X=W.Dictionary=W.Dictionary||{};Y=a.EventTarget;Z=a.Node;_0=J.JS=J.JS||{};_1=W.HashSet=W.HashSet||{};_2=m.TemplateInitializer=m.TemplateInitializer||{};_3=B.VarFloatUnchecked=B.VarFloatUnchecked||{};_4=B.VarBool=B.VarBool||{};_5=B.VarDateTime=B.VarDateTime||{};_6=B.VarFile=B.VarFile||{};_7=B.VarDomElement=B.VarDomElement||{};_8=d.List=d.List||{};_9=_8.T=_8.T||{};_=U.ArrayStorage=U.ArrayStorage||{};$=W.DictionaryUtil=W.DictionaryUtil||{};ba=a.WindowOrWorkerGlobalScope;bb=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};bc=f.Docs=f.Docs||{};bd=f.DocElemNode=f.DocElemNode||{};be=a.CharacterData;bf=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};bg=a.Blob;bh=f.Elt=f.Elt||{};bi=a.Element;bj=N.Prepare=N.Prepare||{};bk=d.Slice=d.Slice||{};bl=f.DomUtility=f.DomUtility||{};bm=W.KeyCollection=W.KeyCollection||{};bn=f.An=f.An||{};bo=M.Settings=M.Settings||{};bp=S.Mailbox=S.Mailbox||{};bq=M.Attrs=M.Attrs||{};br=bq.Dyn=bq.Dyn||{};bs=f.Attrs=f.Attrs||{};bt=B.Attribute=B.Attribute||{};bu=B.Event=B.Event||{};bv=f.AttrModule=f.AttrModule||{};bw=f.AttrProxy=f.AttrProxy||{};bx=B.AfterRender=B.AfterRender||{};by=B.AfterRenderQ=B.AfterRenderQ||{};bz=f.Updates=f.Updates||{};bA=W.ValueCollection=W.ValueCollection||{};bB=M.Docs=M.Docs||{};bC=bB.RunState=bB.RunState||{};bD=bB.NodeSet=bB.NodeSet||{};bE=d.Concurrency=d.Concurrency||{};bF=f.Anims=f.Anims||{};bG=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bH=W.HashSetUtil=W.HashSetUtil||{};bI=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};bJ=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bK=f.AppendList=f.AppendList||{};bL=f.DynamicAttrNode=f.DynamicAttrNode||{};bM=a.Error;bN=d.KeyNotFoundException=d.KeyNotFoundException||{};bO=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};bP=bE.Scheduler=bE.Scheduler||{};bQ=f.Easing=f.Easing||{};bR=bE.AsyncBody=bE.AsyncBody||{};bS=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};bT=bE.CT=bE.CT||{};bU=S.HashSet=S.HashSet||{};bV=d.Queue=d.Queue||{};bW=f.BindVar=f.BindVar||{};bX=f.String=f.String||{};bY=f.CheckedInput=f.CheckedInput||{};bZ=d.CancellationTokenSource=d.CancellationTokenSource||{};b0=bB.DomNodes=bB.DomNodes||{};b1=d.Char=d.Char||{};b2=d.DateUtil=d.DateUtil||{};b3=d.OperationCanceledException=d.OperationCanceledException||{};b4=d.Lazy=d.Lazy||{};b5=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};b6=d.LazyExtensionsProxy=d.LazyExtensionsProxy||{};b7=b6.LazyRecord=b6.LazyRecord||{};b8=a.Date;b9=a.String;b_=d&&d.Runtime;b$=a.console;ca=a.Math;c.Main=function(){var cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB;function cC(cD){var cE,cF,cG,cH,cI,cJ,cK;return(cE=(cF=(cG=(cH=(cI=new p.New$1(),(cI.h.push(new R.New("registereddate",cD.RegisterdDate)),cI)),(cH.h.push(new R.New("coffeename",cD.CoffeeName)),cH)),(cG.h.push(new R.New("mynote",cD.MyNote)),cG)),(cF.h.push(new R.New("level",a.String(cD.Level))),cF)),(cJ=r.CompleteHoles(cE.k,cE.h,[]),(cK=new n.New(cJ[1],u.row(cJ[0])),cE.i=cK,cK))).get_Doc();}cb=g.Create$1("");cc=g.Create$1("");cd=g.Create$1(5);ce=g.Create$1("");cf=g.Create$1("=== REGISTERED COFFEE ===");cg=g.Create$1("Information about the coffee you selected will be displayed here.");ch=g.Create$1("");ci=h.FromSeq([i.Create("","Blue Mountain","Most Favorite!",5),i.Create("","Kona","The second-time purchased",5),i.Create("","Kilimanjaro","",4),i.Create("","Mocha","",4),i.Create("","Java coffee","",3),i.Create("","Toraja","",3),i.Create("","Mandheling","",3)]);cj=h.FromSeq([]);ci.Iter(function(cD){cj.Append(i.Create(cD.RegisterdDate,cD.CoffeeName,cD.MyNote,cD.Level));});ck=w.BindView(function(cD){return w.Concat(v.map(cC,v.sortBy(function(cE){return cE.CoffeeName;},cD)));},cj.v);cl=(cm=(cn=(co=(cp=ch.get_View(),(cq=(cr=cg.get_View(),(cs=(ct=(cu=(cv=(cw=(cx=(cy=cf.get_View(),(cz=new p.New$1(),(cz.h.push(new C.New("caption",cy)),cz))),(cx.h.push(new F.New("data",ck)),cx)),(cw.h.push(new D.New("coffeename",cb)),cw)),(cv.h.push(new D.New("mynote",cc)),cv)),(cu.h.push(new E.New("level",cd)),cu)),(ct.h.push(new D.New("msg",ce)),ct)),(cs.h.push(new C.New("recipe",cr)),cs))),(cq.h.push(new C.New("result",cp)),cq))),(co.h.push(r.EventQ2(co.k,"reister",function(){return co.i;},function(){var cD;cf.Set("=== REGISTERED COFFEE ===");cj.Clear();cD=a.String((new a.Date(b8.now())).getFullYear())+"/"+a.String((new b8(b8.now())).getMonth()+1)+"/"+a.String((new b8(b8.now())).getDate());cj.Append(i.Create(cD,cb.Get(),cc.Get(),cd.Get()));ci.Iter(function(cE){cj.Append(i.Create(cE.RegisterdDate,cE.CoffeeName,cE.MyNote,cE.Level));});ci.Clear();cj.Iter(function(cE){ci.Append(i.Create(cE.RegisterdDate,cE.CoffeeName,cE.MyNote,cE.Level));});cg.Set(cb.Get()=="Blue Mountain"?"BLUE MOUNTAIN has an outstanding aroma, a harmonious taste, a light texture, and a smooth finish.It is said to be of the highest quality. A small percentage of the coffee produced in Jamaica is branded as Blue Mountain.Among them, it is further ranked"+b9.fromCharCode(10)+"Enjoy the taste straight!":cb.Get()=="Java Coffee"?"JAVA COFFEE is Mainly refers to Arabica coffee grown on the island of Java. Round and mild taste."+b9.fromCharCode(10)+"Enjoy the taste Iced Coffee!":cb.Get()=="Kilimanjaro"?"KILIMANJARO is a name for coffee produced in Tanzania.  Characterized by strong acidity and richness.Deep roasts, which are often described as 'full of wildness', have an elegant bitterness that is different from light to medium roasts.":cb.Get()=="Kona"?"KONA has a very strong sourness and rich flavor.It is said to give a good acidity when used in blends, and is the second most expensive brand after Blue Mountain..":cb.Get()=="Mandheling"?"MANDHEILING comes from Sumatra. The taste is mainly bitter and full-bodied, with no acidity and a unique aftertaste.":cb.Get()=="Mocha"?"MOCHA has an excellent aroma and a unique sourness, adding sweetness and richness.It is the oldest brand. It is the origin of coffee, and in Italy and other countries coffee is called mocha.Famous include ``Matali'' from Yemen, ``Harar'' and ``Sidamo'' from Ethiopia.":cb.Get()=="Toraja"?"TORAJA comes from Sulawesi. The taste is mainly bitter, with a very rich flavor and no sourness..":"Cofee \""+b9(cb.Get())+"\" from \""+cc.Get()+"\" is registerd.");ch.Set("As of "+cD+" , the number of lists you have registered is "+b9(cj.get_Length())+".");ce.Set("Coffee \""+b9(cb.Get())+"\" Note: \""+b9(cc.Get())+"\" Level: \""+b9(cd.Get())+"\" is added to the LIST.");cb.Set("");cc.Set("");cd.Set(5);})),co)),(cn.h.push(r.EventQ2(cn.k,"search",function(){return cn.i;},function(){cf.Set("=== MY SEARCH RESULT ===");cj.Clear();cg.Set("");ch.Set("");ci.Iter(function(cD){var cE,cF;if((L.Trim(cb.Get())==""||cD.CoffeeName.toLowerCase().indexOf(cb.Get().toLowerCase())!=-1)&&(L.Trim(cc.Get())==""||cD.MyNote.toLowerCase().indexOf(cc.Get().toLowerCase())!=-1)&&(cE=cd.Get(),t.Equals(cE,"")||b9(cD.Level).indexOf((cF=cd.Get(),b9(cF)))!=-1))cj.Append(i.Create(cD.RegisterdDate,cD.CoffeeName,cD.MyNote,cD.Level));});ce.Set(cj.get_Length()===0?(cj.Append(i.Create("","","",0)),"Coffee \""+cb.Get()+"\" Note: \""+cc.Get()+"\" is not found."):"Coffee \""+cb.Get()+"\" Note: \""+cc.Get()+"\" is found, "+b9(cj.get_Length())+(cj.get_Length()===1?" Coffee.":" Coffee."));})),cn)),(cA=r.CompleteHoles(cm.k,cm.h,[["coffeename",0,null],["mynote",0,null],["level",1,null],["msg",0,null]]),(cB=new n.New(cA[1],u.main(cA[0])),cm.i=cB,cB))).get_Doc();N.LoadLocalTemplates("");w.RunById("main",cl);};e=d.Obj=b_.Class({Equals:function(cb){return this===cb;},GetHashCode:function(){return -1;}},null,e);e.New=b_.Ctor(function(){},e);g=f.Var$1=b_.Class({},e,g);g.Create$1=function(cb){return new y.New(false,z.New({$:2,$0:cb,$1:[]}),cb);};h.FromSeq=function(cb){return h.Create(a.id,cb);};h.Create=function(cb,cc){return h.CreateWithStorage(cb,U.InMemory(o.ofSeq(cc)));};h.CreateWithStorage=function(cb,cc){return new h.New(cb,cc);};i.Create=function(cb,cc,cd,ce){return i.New(cb,cc,cd,ce);};i.New=function(cb,cc,cd,ce){return{RegisterdDate:cb,CoffeeName:cc,MyNote:cd,Level:ce};};h=f.ListModel=b_.Class({Iter:function(cb){o.iter(cb,this["var"].Get());},Clear:function(){this["var"].Set(this.storage.SSet([]));this.ObsoleteAll();},get_Length:function(){return o.length(this["var"].Get());},Append:function(cb){var cc,cd,ce,cf;cc=this;cd=this["var"].Get();ce=this.key(cb);cf=o.tryFindIndex(function(cg){return t.Equals(cc.key(cg),ce);},cd);if(cf!=null&&cf.$==1)this["var"].Set(this.storage.SSetAt(cf.$0,cb,cd));else this["var"].Set(this.storage.SAppend(cb,cd));this.ObsoleteKey(ce);},ObsoleteAll:function(){v.iter(function(cb){z.Obsolete(cb.V);},this.it);this.it.Clear();},ObsoleteKey:function(cb){var cc,cd;cc=(cd=null,[this.it.TryGetValue(cb,{get:function(){return cd;},set:function(ce){cd=ce;}}),cd]);if(cc[0]){z.Obsolete(cc[1]);this.it.RemoveKey(cb);}},GetEnumerator:function(){return O.Get(this["var"].Get());},GetEnumerator0:function(){return O.Get0(this["var"].Get());}},e,h);h.New=b_.Ctor(function(cb,cc){h.New$3.call(this,cb,g.Create$1(o.ofSeq(v.distinctBy(cb,cc.SInit()))),cc);},h);h.New$3=b_.Ctor(function(cb,cc,cd){e.New.call(this);this.key=cb;this["var"]=cc;this.storage=cd;this.v=V.Map(function(ce){return ce.slice();},this["var"].get_View());this.it=new X.New$5();},h);j.FailWith=function(cb){throw new bM(cb);};j.KeyValue=function(cb){return[cb.K,cb.V];};j.range=function(cb,cc){var cd;cd=1+cc-cb;return cd<=0?[]:v.init(cd,function(ce){return ce+cb;});};n=m.TemplateInstance=b_.Class({get_Doc:function(){return this.doc;},SetAnchorRoot:function(cb){this.anchorRoot=cb;}},e,n);n.New=b_.Ctor(function(cb,cc){e.New.call(this);this.doc=cc;this.allVars=cb.$==0?cb.$0:j.FailWith("Should not happen");this.anchorRoot=null;},n);o.length=function(cb){return cb.dims===2?cb.length*cb.length:cb.length;};o.get=function(cb,cc){o.checkBounds(cb,cc);return cb[cc];};o.checkBounds=function(cb,cc){if(cc<0||cc>=cb.length)j.FailWith("Index was outside the bounds of the array.");};o.set=function(cb,cc,cd){o.checkBounds(cb,cc);cb[cc]=cd;};p=m.ProviderBuilder=b_.Class({},e,p);p.New$1=b_.Ctor(function(){var cb;e.New.call(this);this.i=null;this.k=(cb=H.NewGuid(),b9(cb));this.h=b_.MarkResizable([]);b_.SetOptional(this,"s",null);},p);q=f.Var=b_.Class({},e,q);q.New=b_.Ctor(function(){e.New.call(this);},q);r.EventQ2=function(cb,cc,cd,ce){return new I.New(cc,function(cf){return function(cg){var ch;ch=cd();ch.SetAnchorRoot(cf);return ce({Vars:ch,Anchors:ch,Target:cf,Event:cg});};});};r.CompleteHoles=function(cb,cc,cd){var cf,cg,ch,ci,cj;function ce(ck,cl,cm){var cn;return cg.Contains(ck)?null:(cn=t.Equals(cl,0)?_2.GetOrAddHoleFor(cb,ck,function(){return new D.New(ck,g.Create$1(""));}):t.Equals(cl,1)?_2.GetOrAddHoleFor(cb,ck,function(){return new _3.New(ck,g.Create$1(0));}):t.Equals(cl,2)?_2.GetOrAddHoleFor(cb,ck,function(){return new _4.New(ck,g.Create$1(false));}):t.Equals(cl,3)?_2.GetOrAddHoleFor(cb,ck,function(){return new _5.New(ck,g.Create$1(-8640000000000000));}):t.Equals(cl,4)?_2.GetOrAddHoleFor(cb,ck,function(){return new _6.New(ck,g.Create$1([]));}):t.Equals(cl,5)?_2.GetOrAddHoleFor(cb,ck,function(){var co;co=self.document.querySelector("[ws-dom="+ck+"]");co.removeAttribute("ws-dom");return new _7.New(ck,g.Create$1({$:1,$0:co}));}):j.FailWith("Invalid value type"),(cf.set_Item(ck,cn),{$:1,$0:cn}));}cf=new X.New$5();cg=new _1.New$3();ch=O.Get(cc);try{while(ch.MoveNext()){ci=ch.Current();cj=ci.get_Name();cg.SAdd(cj);cf.set_Item(cj,ci);}}finally{if(typeof ch=="object"&&"Dispose"in ch)ch.Dispose();}return[v.append(cc,o.choose(function(ck){return ce(ck[0],ck[1],ck[2]);},cd)),{$:0,$0:cf}];};t.Equals=function(cb,cc){var cd,ce,cf,cg;if(cb===cc)return true;else{cd=typeof cb;if(cd=="object"){if(cb===null||cb===void 0||cc===null||cc===void 0||!t.Equals(typeof cc,"object"))return false;else if("Equals"in cb)return cb.Equals(cc);else if("Equals"in cc)return false;else if(cb instanceof a.Array&&cc instanceof a.Array)return t.arrayEquals(cb,cc);else if(cb instanceof b8&&cc instanceof b8)return t.dateEquals(cb,cc);else{ce=[true];for(var ch in cb)if(function(ci){ce[0]=!cb.hasOwnProperty(ci)||cc.hasOwnProperty(ci)&&t.Equals(cb[ci],cc[ci]);return!ce[0];}(ch))break;if(ce[0]){for(var ci in cc)if(function(cj){ce[0]=!cc.hasOwnProperty(cj)||cb.hasOwnProperty(cj);return!ce[0];}(ci))break;}return ce[0];}}else return cd=="function"&&("$Func"in cb?cb.$Func===cc.$Func&&cb.$Target===cc.$Target:"$Invokes"in cb&&"$Invokes"in cc&&t.arrayEquals(cb.$Invokes,cc.$Invokes));}};t.arrayEquals=function(cb,cc){var cd,ce;if(o.length(cb)===o.length(cc)){cd=true;ce=0;while(cd&&ce<o.length(cb)){!t.Equals(o.get(cb,ce),o.get(cc,ce))?cd=false:void 0;ce=ce+1;}return cd;}else return false;};t.dateEquals=function(cb,cc){return cb.getTime()===cc.getTime();};t.Compare=function(cb,cc){var cd,ce,cf,cg,ch,ci;if(cb===cc)return 0;else{ce=typeof cb;switch(ce=="function"?1:ce=="boolean"?2:ce=="number"?2:ce=="string"?2:ce=="object"?3:0){case 0:return typeof cc=="undefined"?0:-1;case 1:return j.FailWith("Cannot compare function values.");case 2:return cb<cc?-1:1;case 3:if(cb===null)cf=-1;else if(cc===null)cf=1;else if("CompareTo"in cb)cf=cb.CompareTo(cc);else if("CompareTo0"in cb)cf=cb.CompareTo0(cc);else if(cb instanceof a.Array&&cc instanceof a.Array)cf=t.compareArrays(cb,cc);else if(cb instanceof b8&&cc instanceof b8)cf=t.compareDates(cb,cc);else{cg=[0];for(var cj in cb)if(function(ck){return!cb.hasOwnProperty(ck)?false:!cc.hasOwnProperty(ck)?(cg[0]=1,true):(cg[0]=t.Compare(cb[ck],cc[ck]),cg[0]!==0);}(cj))break;if(cg[0]===0){for(var ck in cc)if(function(cl){return!cc.hasOwnProperty(cl)?false:!cb.hasOwnProperty(cl)&&(cg[0]=-1,true);}(ck))break;}cf=cg[0];}return cf;}}};t.Hash=function(cb){var cc;cc=typeof cb;return cc=="function"?0:cc=="boolean"?cb?1:0:cc=="number"?cb:cc=="string"?t.hashString(cb):cc=="object"?cb==null?0:cb instanceof a.Array?t.hashArray(cb):t.hashObject(cb):0;};t.compareArrays=function(cb,cc){var cd,ce;if(o.length(cb)<o.length(cc))return -1;else if(o.length(cb)>o.length(cc))return 1;else{cd=0;ce=0;while(cd===0&&ce<o.length(cb)){cd=t.Compare(o.get(cb,ce),o.get(cc,ce));ce=ce+1;}return cd;}};t.compareDates=function(cb,cc){return t.Compare(cb.getTime(),cc.getTime());};t.hashString=function(cb){var cc,cd,ce;if(cb===null)return 0;else{cc=5381;for(cd=0,ce=cb.length-1;cd<=ce;cd++)cc=t.hashMix(cc,cb[cd].charCodeAt());return cc;}};t.hashArray=function(cb){var cc,cd,ce;cc=-34948909;for(cd=0,ce=o.length(cb)-1;cd<=ce;cd++)cc=t.hashMix(cc,t.Hash(o.get(cb,cd)));return cc;};t.hashObject=function(cb){var cc,cd;if("GetHashCode"in cb)return cb.GetHashCode();else{cc=[0];for(var ce in cb)if(function(cf){cc[0]=t.hashMix(t.hashMix(cc[0],t.hashString(cf)),t.Hash(cb[cf]));return false;}(ce))break;return cc[0];}};t.hashMix=function(cb,cc){return(cb<<5)+cb+cc;};u.main=function(cb){N.LoadLocalTemplates("index");return cb?N.NamedTemplate("index",{$:1,$0:"main"},cb):void 0;};u.row=function(cb){N.LoadLocalTemplates("index");return cb?N.NamedTemplate("index",{$:1,$0:"row"},cb):void 0;};v.sortBy=function(cb,cc){return v.delay(function(){var cd;cd=o.ofSeq(cc);o.sortInPlaceBy(cb,cd);return cd;});};v.map=function(cb,cc){return{GetEnumerator:function(){var cd;cd=O.Get(cc);return new P.New(null,null,function(ce){return cd.MoveNext()&&(ce.c=cb(cd.Current()),true);},function(){cd.Dispose();});}};};v.delay=function(cb){return{GetEnumerator:function(){return O.Get(cb());}};};v.iter=function(cb,cc){var cd;cd=O.Get(cc);try{while(cd.MoveNext())cb(cd.Current());}finally{if(typeof cd=="object"&&"Dispose"in cd)cd.Dispose();}};v.append=function(cb,cc){return{GetEnumerator:function(){var cd,ce;cd=O.Get(cb);ce=[true];return new P.New(cd,null,function(cf){var cg;return cf.s.MoveNext()?(cf.c=cf.s.Current(),true):(cg=cf.s,!t.Equals(cg,null)?cg.Dispose():void 0,cf.s=null,ce[0]&&(ce[0]=false,cf.s=O.Get(cc),cf.s.MoveNext()?(cf.c=cf.s.Current(),true):(cf.s.Dispose(),cf.s=null,false)));},function(cf){var cg;cg=cf.s;if(!t.Equals(cg,null))cg.Dispose();});}};};v.head=function(cb){var cc;cc=O.Get(cb);try{return cc.MoveNext()?cc.Current():v.insufficient();}finally{if(typeof cc=="object"&&"Dispose"in cc)cc.Dispose();}};v.distinctBy=function(cb,cc){return{GetEnumerator:function(){var cd,ce;cd=O.Get(cc);ce=new _1.New$3();return new P.New(null,null,function(cf){var cg,ch;if(cd.MoveNext()){cg=cd.Current();ch=ce.SAdd(cb(cg));while(!ch&&cd.MoveNext()){cg=cd.Current();ch=ce.SAdd(cb(cg));}return ch&&(cf.c=cg,true);}else return false;},function(){cd.Dispose();});}};};v.fold=function(cb,cc,cd){var ce,cf;ce=cc;cf=O.Get(cd);try{while(cf.MoveNext())ce=cb(ce,cf.Current());return ce;}finally{if(typeof cf=="object"&&"Dispose"in cf)cf.Dispose();}};v.max=function(cb){var cc,cd,ce;cc=O.Get(cb);try{if(!cc.MoveNext())v.seqEmpty();cd=cc.Current();while(cc.MoveNext()){ce=cc.Current();if(t.Compare(ce,cd)===1)cd=ce;}return cd;}finally{if(typeof cc=="object"&&"Dispose"in cc)cc.Dispose();}};v.init=function(cb,cc){return v.take(cb,v.initInfinite(cc));};v.seqEmpty=function(){return j.FailWith("The input sequence was empty.");};v.forall=function(cb,cc){return!v.exists(function(cd){return!cb(cd);},cc);};v.take=function(cb,cc){cb<0?v.nonNegative():void 0;return{GetEnumerator:function(){var cd;cd=[O.Get(cc)];return new P.New(0,null,function(ce){var cf;ce.s=ce.s+1;return ce.s>cb?false:(cf=cd[0],t.Equals(cf,null)?v.insufficient():cf.MoveNext()?(ce.c=cf.Current(),ce.s===cb?(cf.Dispose(),cd[0]=null):void 0,true):(cf.Dispose(),cd[0]=null,v.insufficient()));},function(){var ce;ce=cd[0];if(!t.Equals(ce,null))ce.Dispose();});}};};v.initInfinite=function(cb){return{GetEnumerator:function(){return new P.New(0,null,function(cc){cc.c=cb(cc.s);cc.s=cc.s+1;return true;},void 0);}};};v.exists=function(cb,cc){var cd,ce;cd=O.Get(cc);try{ce=false;while(!ce&&cd.MoveNext())ce=cb(cd.Current());return ce;}finally{if(typeof cd=="object"&&"Dispose"in cd)cd.Dispose();}};w=f.Doc=b_.Class({},e,w);w.Concat=function(cb){var cc;cc=Q.ofSeqNonCopying(cb);return Q.TreeReduce(w.get_Empty(),w.Append,cc);};w.RunById=function(cb,cc){var cd;cd=self.document.getElementById(cb);if(t.Equals(cd,null))j.FailWith("invalid id: "+cb);else w.Run(cd,cc);};w.Append=function(cb,cc){return w.Mk({$:0,$0:cb.docNode,$1:cc.docNode},V.Map2Unit(cb.updates,cc.updates));};w.get_Empty=function(){return w.Mk(null,V.Const());};w.Run=function(cb,cc){bc.LinkElement(cb,cc.docNode);w.RunInPlace(false,cb,cc);};w.BindView=function(cb,cc){return w.EmbedView(V.Map(cb,cc));};w.Mk=function(cb,cc){return new w.New(cb,cc);};w.RunInPlace=function(cb,cc,cd){var ce;ce=bc.CreateRunState(cc,cd.docNode);V.Sink(bn.get_UseAnimations()||bo.BatchUpdatesEnabled()?bp.StartProcessor(bc.PerformAnimatedUpdate(cb,ce,cd.docNode)):function(){bc.PerformSyncUpdate(cb,ce,cd.docNode);},cd.updates);};w.EmbedView=function(cb){var cc;cc=bc.CreateEmbedNode();return w.Mk({$:2,$0:cc},V.Map(a.ignore,V.Bind(function(cd){bc.UpdateEmbedNode(cc,cd.docNode);return cd.updates;},cb)));};w.TextNode=function(cb){return w.Mk({$:5,$0:self.document.createTextNode(cb)},V.Const());};w.TextView=function(cb){var cc;cc=bc.CreateTextNode();return w.Mk({$:4,$0:cc},V.Map(function(cd){bc.UpdateTextNode(cc,cd);},cb));};w.New=b_.Ctor(function(cb,cc){e.New.call(this);this.docNode=cb;this.updates=cc;},w);x=f.TemplateHole=b_.Class({ForTextView:function(){b$.warn("Content hole filled with attribute data",this.get_Name());return null;},AddAttribute:function(cb,cc){b$.warn("Var hole filled with non-Var data",this.get_Name());},get_AsChoiceView:function(){b$.warn("Attribute value hole filled with non-text data",this.get_Name());return{$:0,$0:""};}},e,x);x.New=b_.Ctor(function(){e.New.call(this);},x);y=f.ConcreteVar=b_.Class({get_View:function(){return this.view;},Set:function(cb){if(this.isConst)(function(cc){return cc("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(cc){b$.log(cc);}));else{z.Obsolete(this.snap);this.current=cb;this.snap=z.New({$:2,$0:cb,$1:[]});}},Get:function(){return this.current;},SetFinal:function(cb){if(this.isConst)(function(cc){return cc("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(cc){b$.log(cc);}));else{z.Obsolete(this.snap);this.isConst=true;this.current=cb;this.snap=z.New({$:0,$0:cb});}},UpdateMaybe:function(cb){var cc;cc=cb(this.Get());if(cc!=null&&cc.$==1)this.Set(cc.$0);}},q,y);y.New=b_.Ctor(function(cb,cc,cd){var ce;ce=this;q.New.call(this);this.isConst=cb;this.current=cd;this.snap=cc;this.view=function(){return ce.snap;};this.id=T.Int();},y);z.Map2Unit=function(cb,cc){var cd,ce,cf;function cg(){var ch,ci,cj;if(!(ch=cf.s,ch!=null&&ch.$==0||ch!=null&&ch.$==2)){ci=z.ValueAndForever(cb);cj=z.ValueAndForever(cc);if(ci!=null&&ci.$==1)cj!=null&&cj.$==1?ci.$0[1]&&cj.$0[1]?z.MarkForever(cf,null):z.MarkReady(cf,null):void 0;}}cd=cb.s;ce=cc.s;return cd!=null&&cd.$==0?ce!=null&&ce.$==0?z.New({$:0,$0:null}):cc:ce!=null&&ce.$==0?cb:(cf=z.New({$:3,$0:[],$1:[]}),(z.When(cb,cg,cf),z.When(cc,cg,cf),cf));};z.Map=function(cb,cc){var cd,ce;cd=cc.s;return cd!=null&&cd.$==0?z.New({$:0,$0:cb(cd.$0)}):(ce=z.New({$:3,$0:[],$1:[]}),(z.When(cc,function(cf){z.MarkDone(ce,cc,cb(cf));},ce),ce));};z.WhenObsoleteRun=function(cb,cc){var cd;cd=cb.s;if(cd==null)cc();else cd!=null&&cd.$==2?cd.$1.push(cc):cd!=null&&cd.$==3?cd.$1.push(cc):void 0;};z.ValueAndForever=function(cb){var cc;cc=cb.s;return cc!=null&&cc.$==0?{$:1,$0:[cc.$0,true]}:cc!=null&&cc.$==2?{$:1,$0:[cc.$0,false]}:null;};z.MarkForever=function(cb,cc){var cd,ce,cf,cg;cd=cb.s;if(cd!=null&&cd.$==3){cb.s={$:0,$0:cc};ce=cd.$0;for(cf=0,cg=o.length(ce)-1;cf<=cg;cf++)(o.get(ce,cf))(cc);}else void 0;};z.MarkReady=function(cb,cc){var cd,ce,cf,cg;cd=cb.s;if(cd!=null&&cd.$==3){cb.s={$:2,$0:cc,$1:cd.$1};ce=cd.$0;for(cf=0,cg=o.length(ce)-1;cf<=cg;cf++)(o.get(ce,cf))(cc);}else void 0;};z.When=function(cb,cc,cd){var ce;ce=cb.s;if(ce==null)z.Obsolete(cd);else ce!=null&&ce.$==2?(z.EnqueueSafe(ce.$1,cd),cc(ce.$0)):ce!=null&&ce.$==3?(ce.$0.push(cc),z.EnqueueSafe(ce.$1,cd)):cc(ce.$0);};z.WhenRun=function(cb,cc,cd){var ce;ce=cb.s;if(ce==null)cd();else ce!=null&&ce.$==2?(ce.$1.push(cd),cc(ce.$0)):ce!=null&&ce.$==3?(ce.$0.push(cc),ce.$1.push(cd)):cc(ce.$0);};z.MarkDone=function(cb,cc,cd){var ce;if(ce=cc.s,ce!=null&&ce.$==0)z.MarkForever(cb,cd);else z.MarkReady(cb,cd);};z.EnqueueSafe=function(cb,cc){var cd,ce,cf,cg;cb.push(cc);if(cb.length%20===0){cd=cb.slice(0);bV.Clear(cb);for(ce=0,cf=o.length(cd)-1;ce<=cf;ce++){cg=o.get(cd,ce);if(typeof cg=="object")(function(ch){if(ch.s)cb.push(ch);}(cg));else(function(ch){cb.push(ch);}(cg));}}else void 0;};z.Map3=function(cb,cc,cd,ce){var cf,cg,ch,ci;function cj(ck){var cl,cm,cn,co;if(!(cl=ci.s,cl!=null&&cl.$==0||cl!=null&&cl.$==2)){cm=z.ValueAndForever(cc);cn=z.ValueAndForever(cd);co=z.ValueAndForever(ce);if(cm!=null&&cm.$==1)cn!=null&&cn.$==1?co!=null&&co.$==1?cm.$0[1]&&cn.$0[1]&&co.$0[1]?z.MarkForever(ci,cb(cm.$0[0],cn.$0[0],co.$0[0])):z.MarkReady(ci,cb(cm.$0[0],cn.$0[0],co.$0[0])):void 0:void 0;}}cf=cc.s;cg=cd.s;ch=ce.s;return cf!=null&&cf.$==0?cg!=null&&cg.$==0?ch!=null&&ch.$==0?z.New({$:0,$0:cb(cf.$0,cg.$0,ch.$0)}):z.Map3Opt1(cb,cf.$0,cg.$0,ce):ch!=null&&ch.$==0?z.Map3Opt2(cb,cf.$0,ch.$0,cd):z.Map3Opt3(cb,cf.$0,cd,ce):cg!=null&&cg.$==0?ch!=null&&ch.$==0?z.Map3Opt4(cb,cg.$0,ch.$0,cc):z.Map3Opt5(cb,cg.$0,cc,ce):ch!=null&&ch.$==0?z.Map3Opt6(cb,ch.$0,cc,cd):(ci=z.New({$:3,$0:[],$1:[]}),(z.When(cc,cj,ci),z.When(cd,cj,ci),z.When(ce,cj,ci),ci));};z.Sequence=function(cb){var cc,cd,ce;function cf(cg){var ch;if(ce[0]===0){ch=o.map(function(ci){var cj;cj=ci.s;return cj!=null&&cj.$==0?cj.$0:cj!=null&&cj.$==2?cj.$0:j.FailWith("value not found by View.Sequence");},cc);if(o.forall(function(ci){var cj;cj=ci.s;return cj!=null&&cj.$==0;},cc))z.MarkForever(cd,ch);else z.MarkReady(cd,ch);}else ce[0]=ce[0]-1;}cc=o.ofSeq(cb);return cc.length==0?z.New({$:0,$0:[]}):(cd=z.New({$:3,$0:[],$1:[]}),(ce=[o.length(cc)-1],(o.iter(function(cg){z.When(cg,cf,cd);},cc),cd)));};z.Map2=function(cb,cc,cd){var ce,cf,cg;function ch(ci){var cj,ck,cl;if(!(cj=cg.s,cj!=null&&cj.$==0||cj!=null&&cj.$==2)){ck=z.ValueAndForever(cc);cl=z.ValueAndForever(cd);if(ck!=null&&ck.$==1)cl!=null&&cl.$==1?ck.$0[1]&&cl.$0[1]?z.MarkForever(cg,cb(ck.$0[0],cl.$0[0])):z.MarkReady(cg,cb(ck.$0[0],cl.$0[0])):void 0;}}ce=cc.s;cf=cd.s;return ce!=null&&ce.$==0?cf!=null&&cf.$==0?z.New({$:0,$0:cb(ce.$0,cf.$0)}):z.Map2Opt1(cb,ce.$0,cd):cf!=null&&cf.$==0?z.Map2Opt2(cb,cf.$0,cc):(cg=z.New({$:3,$0:[],$1:[]}),(z.When(cc,ch,cg),z.When(cd,ch,cg),cg));};z.Copy=function(cb){var cc,cd,ce;cc=cb.s;return cc==null?cb:cc!=null&&cc.$==2?(cd=z.New({$:2,$0:cc.$0,$1:[]}),(z.WhenObsolete(cb,cd),cd)):cc!=null&&cc.$==3?(ce=z.New({$:3,$0:[],$1:[]}),(z.When(cb,function(cf){z.MarkDone(ce,cb,cf);},ce),ce)):cb;};z.Join=function(cb){var cc;cc=z.New({$:3,$0:[],$1:[]});z.When(cb,function(cd){var ce;ce=cd();z.When(ce,function(cf){var cg,ch;if((cg=ce.s,cg!=null&&cg.$==0)&&(ch=cb.s,ch!=null&&ch.$==0))z.MarkForever(cc,cf);else z.MarkReady(cc,cf);},cc);},cc);return cc;};z.Map3Opt1=function(cb,cc,cd,ce){return z.Map(function(cf){return cb(cc,cd,cf);},ce);};z.Map3Opt2=function(cb,cc,cd,ce){return z.Map(function(cf){return cb(cc,cf,cd);},ce);};z.Map3Opt3=function(cb,cc,cd,ce){return z.Map2(function(cf,cg){return cb(cc,cf,cg);},cd,ce);};z.Map3Opt4=function(cb,cc,cd,ce){return z.Map(function(cf){return cb(cf,cc,cd);},ce);};z.Map3Opt5=function(cb,cc,cd,ce){return z.Map2(function(cf,cg){return cb(cf,cc,cg);},cd,ce);};z.Map3Opt6=function(cb,cc,cd,ce){return z.Map2(function(cf,cg){return cb(cf,cg,cc);},cd,ce);};z.Map2Opt1=function(cb,cc,cd){return z.Map(function(ce){return cb(cc,ce);},cd);};z.Map2Opt2=function(cb,cc,cd){return z.Map(function(ce){return cb(ce,cc);},cd);};z.WhenObsolete=function(cb,cc){var cd;cd=cb.s;if(cd==null)z.Obsolete(cc);else cd!=null&&cd.$==2?z.EnqueueSafe(cd.$1,cc):cd!=null&&cd.$==3?z.EnqueueSafe(cd.$1,cc):void 0;};o.iter=function(cb,cc){var cd,ce;for(cd=0,ce=cc.length-1;cd<=ce;cd++)cb(cc[cd]);};o.ofSeq=function(cb){var cc,cd;if(cb instanceof a.Array)return cb.slice();else if(cb instanceof _9)return o.ofList(cb);else{cc=[];cd=O.Get(cb);try{while(cd.MoveNext())cc.push(cd.Current());return cc;}finally{if(typeof cd=="object"&&"Dispose"in cd)cd.Dispose();}}};o.sortInPlaceBy=function(cb,cc){o.mapInPlace(function(cd){return cd[0];},o.mapiInPlace(function(cd,ce){return[ce,[cb(ce),cd]];},cc).sort(function(cd,ce){return t.Compare(cd[1],ce[1]);}));};o.tryFindIndex=function(cb,cc){var cd,ce;cd=null;ce=0;while(ce<cc.length&&cd==null){cb(cc[ce])?cd={$:1,$0:ce}:void 0;ce=ce+1;}return cd;};o.choose=function(cb,cc){var cd,ce,cf,cg;cd=[];for(ce=0,cf=cc.length-1;ce<=cf;ce++){cg=cb(cc[ce]);if(cg==null);else cd.push(cg.$0);}return cd;};o.ofList=function(cb){var cc,cd;cd=[];cc=cb;while(!(cc.$==0)){cd.push(_8.head(cc));cc=_8.tail(cc);}return cd;};o.tryPick=function(cb,cc){var cd,ce,cf;cd=null;ce=0;while(ce<cc.length&&cd==null){cf=cb(cc[ce]);if(cf!=null&&cf.$==1)cd=cf;ce=ce+1;}return cd;};o.exists=function(cb,cc){var cd,ce,cf,cg;cd=false;ce=0;cg=o.length(cc);while(!cd&&ce<cg)if(cb(cc[ce]))cd=true;else ce=ce+1;return cd;};o.concat=function(cb){return a.Array.prototype.concat.apply([],o.ofSeq(cb));};o.filter=function(cb,cc){var cd,ce,cf;cd=[];for(ce=0,cf=cc.length-1;ce<=cf;ce++)if(cb(cc[ce]))cd.push(cc[ce]);return cd;};o.foldBack=function(cb,cc,cd){var ce,cf,cg,ch,ci;ce=cd;cg=cc.length;for(ch=1,ci=cg;ch<=ci;ch++)ce=cb(cc[cg-ch],ce);return ce;};o.map=function(cb,cc){var cd,ce,cf;cd=new a.Array(cc.length);for(ce=0,cf=cc.length-1;ce<=cf;ce++)cd[ce]=cb(cc[ce]);return cd;};o.pick=function(cb,cc){var cd;cd=o.tryPick(cb,cc);return cd==null?j.FailWith("KeyNotFoundException"):cd.$0;};o.forall=function(cb,cc){var cd,ce,cf,cg;cd=true;ce=0;cg=o.length(cc);while(cd&&ce<cg)if(cb(cc[ce]))ce=ce+1;else cd=false;return cd;};o.create=function(cb,cc){var cd,ce,cf;cd=new a.Array(cb);for(ce=0,cf=cb-1;ce<=cf;ce++)cd[ce]=cc;return cd;};o.init=function(cb,cc){var cd,ce,cf;if(cb<0)j.FailWith("Negative size given.");else null;cd=new a.Array(cb);for(ce=0,cf=cb-1;ce<=cf;ce++)cd[ce]=cc(ce);return cd;};A.TryParseInt32=function(cb,cc){return A.TryParse(cb,-2147483648,2147483647,cc);};C=B.TextView=b_.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:this.fillWith};},get_AsChoiceView:function(){return{$:1,$0:this.fillWith};}},x,C);C.New=b_.Ctor(function(cb,cc){x.New.call(this);this.name=cb;this.fillWith=cc;},C);D=B.VarStr=b_.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:this.fillWith.get_View()};},AddAttribute:function(cb,cc){(cb(cc))(bv.Value(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:V.Map(b9,this.fillWith.get_View())};}},x,D);D.New=b_.Ctor(function(cb,cc){x.New.call(this);this.name=cb;this.fillWith=cc;},D);E=B.VarIntUnchecked=b_.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:V.Map(b9,this.fillWith.get_View())};},AddAttribute:function(cb,cc){(cb(cc))(bv.IntValueUnchecked(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:V.Map(b9,this.fillWith.get_View())};}},x,E);E.New=b_.Ctor(function(cb,cc){x.New.call(this);this.name=cb;this.fillWith=cc;},E);F=B.Elt=b_.Class({get_Name:function(){return this.name;},get_Value:function(){return this.fillWith;}},x,F);F.New=b_.Ctor(function(cb,cc){x.New.call(this);this.name=cb;this.fillWith=cc;},F);H.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new a.RegExp("[xy]","g"),function(cb){var cc,cd;cc=ca.random()*16|0;cd=cb=="x"?cc:cc&3|8;return cd.toString(16);});};I=B.EventQ=b_.Class({get_Name:function(){return this.name;},get_Value:function(){return this.fillWith;}},x,I);I.New=b_.Ctor(function(cb,cc){x.New.call(this);this.name=cb;this.fillWith=cc;},I);K.NewFromSeq=function(cb){var cc,cd,ce;cc={};cd=O.Get(cb);try{while(cd.MoveNext()){ce=cd.Current();cc[ce[0]]=ce[1];}}finally{if(typeof cd=="object"&&"Dispose"in cd)cd.Dispose();}return cc;};L.Trim=function(cb){return cb.replace(new a.RegExp("^\\s+"),"").replace(new a.RegExp("\\s+$"),"");};L.concat=function(cb,cc){return o.ofSeq(cc).join(cb);};L.SplitChars=function(cb,cc,cd){return L.Split(cb,new a.RegExp("["+L.RegexEscape(cc.join(""))+"]"),cd);};L.StartsWith=function(cb,cc){return cb.substring(0,cc.length)==cc;};L.Split=function(cb,cc,cd){return cd===1?o.filter(function(ce){return ce!=="";},L.SplitWith(cb,cc)):L.SplitWith(cb,cc);};L.RegexEscape=function(cb){return cb.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};L.SplitWith=function(cb,cc){return cb.split(cc);};L.forall=function(cb,cc){return v.forall(cb,L.protect(cc));};L.protect=function(cb){return cb==null?"":cb;};N.LoadLocalTemplates=function(cb){!N.LocalTemplatesLoaded()?(N.set_LocalTemplatesLoaded(true),N.LoadNestedTemplates(self.document.body,"")):void 0;N.LoadedTemplates().set_Item(cb,N.LoadedTemplateFile(""));};N.NamedTemplate=function(cb,cc,cd){var ce,cf;ce=(cf=null,[N.LoadedTemplateFile(cb).TryGetValue(cc==null?"":cc.$0,{get:function(){return cf;},set:function(cg){cf=cg;}}),cf]);return ce[0]?N.ChildrenTemplate(ce[1].cloneNode(true),cd):(b$.warn("Local template doesn't exist",cc),w.get_Empty());};N.LocalTemplatesLoaded=function(){bb.$cctor();return bb.LocalTemplatesLoaded;};N.set_LocalTemplatesLoaded=function(cb){bb.$cctor();bb.LocalTemplatesLoaded=cb;};N.LoadNestedTemplates=function(cb,cc){var ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy;function cd(cz){var cA,cB;if(!ce.ContainsKey(cz)){cA=(cB=null,[cf.TryGetValue(cz,{get:function(){return cB;},set:function(cC){cB=cC;}}),cB]);if(cA[0]){cy.SAdd(cz);cf.RemoveKey(cz);N.PrepareTemplateStrict(cc,{$:1,$0:cz},cA[1],{$:1,$0:cd});}else b$.warn(cy.Contains(cz)?"Encountered loop when instantiating "+cz:"Local template does not exist: "+cz);}}ce=N.LoadedTemplateFile(cc);cf=new X.New$5();cg=cb.querySelectorAll("[ws-template]");for(ch=0,ci=cg.length-1;ch<=ci;ch++){cj=cg[ch];ck=cj.getAttribute("ws-template").toLowerCase();cj.removeAttribute("ws-template");cf.set_Item(ck,N.FakeRootSingle(cj));}cl=cb.querySelectorAll("[ws-children-template]");for(cm=0,cn=cl.length-1;cm<=cn;cm++){co=cl[cm];cp=co.getAttribute("ws-children-template").toLowerCase();co.removeAttribute("ws-children-template");cf.set_Item(cp,N.FakeRoot(co));}cq=cb.querySelectorAll("template[id]");for(cr=0,cs=cq.length-1;cr<=cs;cr++){ct=cq[cr];cf.set_Item(ct.getAttribute("id").toLowerCase(),N.FakeRootFromHTMLTemplate(ct));}cu=cb.querySelectorAll("template[name]");for(cv=0,cw=cu.length-1;cv<=cw;cv++){cx=cu[cv];cf.set_Item(cx.getAttribute("name").toLowerCase(),N.FakeRootFromHTMLTemplate(cx));}cy=new _1.New$3();while(cf.count>0)cd(v.head(cf.Keys()));};N.LoadedTemplates=function(){bb.$cctor();return bb.LoadedTemplates;};N.LoadedTemplateFile=function(cb){var cc,cd,ce;cc=(cd=null,[N.LoadedTemplates().TryGetValue(cb,{get:function(){return cd;},set:function(cf){cd=cf;}}),cd]);return cc[0]?cc[1]:(ce=new X.New$5(),(N.LoadedTemplates().set_Item(cb,ce),ce));};N.ChildrenTemplate=function(cb,cc){var cd,ce,cf,cg,ch;cd=N.InlineTemplate(cb,v.append(cc,N.GlobalHoles().Values()));ce=cd[1];cf=cd[0];cg=cf.Els;return!t.Equals(cg,null)&&cg.length===1&&(o.get(cg,0)instanceof Z&&(t.Equals(o.get(cg,0).nodeType,Z.ELEMENT_NODE)&&(ch=o.get(cg,0),true)))?bh.TreeNode(cf,ce):w.Mk({$:6,$0:cf},ce);};N.FakeRootSingle=function(cb){var cc,cd,ce,cf;cb.removeAttribute("ws-template");cc=cb.getAttribute("ws-replace");if(cc==null);else{cb.removeAttribute("ws-replace");cd=cb.parentNode;t.Equals(cd,null)?void 0:(ce=self.document.createElement(cb.tagName),ce.setAttribute("ws-replace",cc),cd.replaceChild(ce,cb));}cf=self.document.createElement("div");cf.appendChild(cb);return cf;};N.FakeRoot=function(cb){var cc;cc=self.document.createElement("div");while(cb.hasChildNodes())cc.appendChild(cb.firstChild);return cc;};N.FakeRootFromHTMLTemplate=function(cb){var cc,cd,ce,cf;cc=self.document.createElement("div");cd=cb.content;for(ce=0,cf=cd.childNodes.length-1;ce<=cf;ce++)cc.appendChild(cd.childNodes[ce].cloneNode(true));return cc;};N.PrepareTemplateStrict=function(cb,cc,cd,ce){var cf,cg;function ch(cn,co){var cp,cq,cr,cs,ct,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP;function cu(cQ){}while(true)switch(cn){case 0:if(co!==null){cp=co.nextSibling;if(t.Equals(co.nodeType,Z.TEXT_NODE))bj.convertTextNode(co);else if(t.Equals(co.nodeType,Z.ELEMENT_NODE))cj(co);co=cp;}else return null;break;case 1:cv=bk.string(co.nodeName,{$:1,$0:3},null).toLowerCase();cw=(cq=cv.indexOf("."),cq===-1?[cb,cv]:[bk.string(cv,null,{$:1,$0:cq-1}),bk.string(cv,{$:1,$0:cq+1},null)]);cx=cw[1];cy=cw[0];if(cy!=""&&!N.LoadedTemplates().ContainsKey(cy))return bj.failNotLoaded(cx);else{if(cy==""&&ce!=null)ce.$0(cx);cz=N.LoadedTemplates().Item(cy);if(!cz.ContainsKey(cx))return bj.failNotLoaded(cx);else{cA=cz.Item(cx);cB=cA.cloneNode(true);cC=new _1.New$3();cD=new X.New$5();cE=co.attributes;for(cF=0,cG=cE.length-1;cF<=cG;cF++){cH=cE.item(cF).name.toLowerCase();cD.set_Item(cH,(cI=cE.item(cF).nodeValue,cI==""?cH:cI.toLowerCase()));if(!cC.SAdd(cH))b$.warn("Hole mapped twice",cH);}for(cJ=0,cK=co.childNodes.length-1;cJ<=cK;cJ++){cL=co.childNodes[cJ];if(t.Equals(cL.nodeType,Z.ELEMENT_NODE))!cC.SAdd(cL.nodeName.toLowerCase())?b$.warn("Hole filled twice",cx):void 0;}cM=co.childNodes.length===1&&t.Equals(co.firstChild.nodeType,Z.TEXT_NODE);if(cM){cs=bj.fillTextHole(cB,co.firstChild.textContent,cx);((function(cQ){return function(cR){if(cR!=null)cQ(cR.$0);};}((ct=function(cQ){return function(cR){return cQ.SAdd(cR);};}(cC),function(cQ){return cu(ct(cQ));})))(cs));}bj.removeHolesExcept(cB,cC);if(!cM){for(cN=0,cO=co.childNodes.length-1;cN<=cO;cN++){cP=co.childNodes[cN];if(t.Equals(cP.nodeType,Z.ELEMENT_NODE))cP.hasAttributes()?bj.fillInstanceAttrs(cB,cP):ci(cB,cP);}}bj.mapHoles(cB,cD);bj.fill(cB,co.parentNode,co);co.parentNode.removeChild(co);return;}}break;}}function ci(cn,co){var cp,cq,cs,ct;function cr(cu,cv){var cw;if(cs=="title"&&co.hasChildNodes()){cw=bl.ParseHTMLIntoFakeRoot(co.textContent);co.removeChild(co.firstChild);while(cw.hasChildNodes())co.appendChild(cw.firstChild);}else null;cj(co);return bj.fill(co,cu,cv);}cs=co.nodeName.toLowerCase();N.foreachNotPreserved(cn,"[ws-attr-holes]",function(cu){var cv,cw,cx,cy,cz;cv=L.SplitChars(cu.getAttribute("ws-attr-holes"),[" "],1);for(cw=0,cx=cv.length-1;cw<=cx;cw++){cy=o.get(cv,cw);cu.setAttribute(cy,(cz=new a.RegExp("\\${"+cs+"}","ig"),cu.getAttribute(cy).replace(cz,co.textContent)));}});ct=cn.querySelector("[ws-hole="+cs+"]");if(t.Equals(ct,null)){cp=cn.querySelector("[ws-replace="+cs+"]");return t.Equals(cp,null)?(cq=cn.querySelector("slot[name="+cs+"]"),cn.tagName.toLowerCase()=="template"?(cr(cq.parentNode,cq),void cq.parentNode.removeChild(cq)):null):(cr(cp.parentNode,cp),void cp.parentNode.removeChild(cp));}else{while(ct.hasChildNodes())ct.removeChild(ct.lastChild);ct.removeAttribute("ws-hole");return cr(ct,null);}}function cj(cn){if(!cn.hasAttribute("ws-preserve"))if(L.StartsWith(cn.nodeName.toLowerCase(),"ws-"))cl(cn);else{bj.convertAttrs(cn);ck(cn.firstChild);}}function ck(cn){return ch(0,cn);}function cl(cn){return ch(1,cn);}function cm(cn){var co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz;while(true){co=cn.querySelector("[ws-template]");if(t.Equals(co,null)){cp=cn.querySelector("[ws-children-template]");if(t.Equals(cp,null)){cq=cn.querySelectorAll("template[id]");for(cr=1,cs=cq.length-1;cr<=cs;cr++){ct=cq[cr];if(cf.Contains(ct));else{N.PrepareTemplateStrict(cb,{$:1,$0:ct.getAttribute("id")},ct,null);cf.SAdd(ct);}}cu=cn.querySelectorAll("template[name]");for(cv=1,cw=cu.length-1;cv<=cw;cv++){cx=cu[cv];if(cf.Contains(cx));else{N.PrepareTemplateStrict(cb,{$:1,$0:cx.getAttribute("name")},cx,null);cf.SAdd(cx);}}return null;}else{cy=cp.getAttribute("ws-children-template");cp.removeAttribute("ws-children-template");N.PrepareTemplateStrict(cb,{$:1,$0:cy},cp,null);cn=cn;}}else{cz=co.getAttribute("ws-template");(N.PrepareSingleTemplate(cb,{$:1,$0:cz},co))(null);cn=cn;}}}cf=new _1.New$3();cg=(cc==null?"":cc.$0).toLowerCase();N.LoadedTemplateFile(cb).set_Item(cg,cd);if(cd.hasChildNodes()){cm(cd);ck(cd.firstChild);}};N.InlineTemplate=function(cb,cc){var cd,ce,cf,cg,ch,cl,cm,cn,co,cp,cq,cr;function ci(cs,ct){var cu,cv,cw;cu=bs.Insert(cs,ct);cm.push(bs.Updates(cu));cn.push([cs,cu]);cv=b_.GetOptional(cu.OnAfterRender);return cv==null?null:(cw=cv.$0,void co.push(function(){cw(cs);}));}function cj(cs){var ct,cu,cv,cw;ct=(cu=null,[cp.TryGetValue(cs,{get:function(){return cu;},set:function(cx){cu=cx;}}),cu]);return ct[0]?(cv=ct[1],cv instanceof F?{$:1,$0:cv.get_Value()}:cv instanceof R?{$:1,$0:w.TextNode(cv.get_Value())}:(cw=cv.ForTextView(),cw==null?null:{$:1,$0:w.TextView(cw.$0)})):null;}function ck(){N.foreachNotPreservedwsDOM("[ws-dom]",function(cs){var ct,cu,cv,cw,cx,cy,cz;ct=(cu=null,[cp.TryGetValue(cs.getAttribute("ws-dom").toLowerCase(),{get:function(){return cu;},set:function(cA){cu=cA;}}),cu]);if(ct[0]){cv=ct[1];cv instanceof _7?(cw=cv.get_Value(),cs.removeAttribute("ws-dom"),cx=cs,cy=new a.MutationObserver(function(cA,cB){o.iter(function(cC){function cD(cE,cF,cG,cH){if(cE===cx&&cC.addedNodes.length!==1){cw.SetFinal(null);cB.disconnect();}}cC.removedNodes.forEach(b_.CreateFuncWithArgs(function(cE){return cD(cE[0],cE[1],cE[2],cE[3]);}),null);},cA);}),cs.parentElement!==null?cy.observe(cs.parentElement,(cz={},cz.childList=true,cz)):void 0,cw.Set({$:1,$0:cs}),V.Sink(function(cA){var cB;if(cA!=null&&cA.$==1){cB=cA.$0;if(cx===cB);else{cx.replaceWith.apply(cx,[cB]);cx=cB;}}else{cx.remove();cy.disconnect();}},cw.get_View())):void 0;}});}cl=[];cm=[];cn=[];co=[];cp=new X.New$5();cq=O.Get(cc);try{while(cq.MoveNext()){cr=cq.Current();cp.set_Item(cr.get_Name(),cr);}}finally{if(typeof cq=="object"&&"Dispose"in cq)cq.Dispose();}cd=bl.ChildrenArray(cb);N.foreachNotPreserved(cb,"[ws-hole]",function(cs){var ct,cu,cv;cv=cs.getAttribute("ws-hole");cs.removeAttribute("ws-hole");while(cs.hasChildNodes())cs.removeChild(cs.lastChild);ct=cj(cv);if(ct!=null&&ct.$==1){cu=ct.$0;bc.LinkElement(cs,cu.docNode);cl.push(bd.New(bs.Empty(cs),cu.docNode,null,cs,T.Int(),null));cm.push(cu.updates);}});N.foreachNotPreserved(cb,"[ws-replace]",function(cs){var ct,cu,cv,cw,cx,cy;ct=cj(cs.getAttribute("ws-replace"));if(ct!=null&&ct.$==1){cu=ct.$0;cv=cs.parentNode;cw=self.document.createTextNode("");cv.replaceChild(cw,cs);cx=bc.InsertBeforeDelim(cw,cu.docNode);cy=o.tryFindIndex(function(cz){return cs===cz;},cd);cy==null?void 0:o.set(cd,cy.$0,cu.docNode);cl.push(bd.New(bs.Empty(cv),cu.docNode,{$:1,$0:[cx,cw]},cv,T.Int(),null));cm.push(cu.updates);}});ce=false;N.foreachNotPreserved(cb,"slot",function(cs){var ct,cu,cv,cw;cv=cs.getAttribute("name");cw=cv==""||cv==null?"default":cv.toLowerCase();if(ce&&cw=="default"||!t.Equals(cb.parentElement,null))void 0;else{while(cs.hasChildNodes())cs.removeChild(cs.lastChild);if(cw=="default")ce=true;ct=cj(cw);if(ct!=null&&ct.$==1){cu=ct.$0;bc.LinkElement(cs,cu.docNode);cl.push(bd.New(bs.Empty(cs),cu.docNode,null,cs,T.Int(),null));cm.push(cu.updates);}}});N.foreachNotPreserved(cb,"[ws-attr]",function(cs){var ct,cu,cv,cw;ct=cs.getAttribute("ws-attr");cs.removeAttribute("ws-attr");cu=(cv=null,[cp.TryGetValue(ct,{get:function(){return cv;},set:function(cx){cv=cx;}}),cv]);if(cu[0]){cw=cu[1];cw instanceof bt?ci(cs,cw.get_Value()):b$.warn("Attribute hole filled with non-attribute data",ct);}});N.foreachNotPreserved(cb,"[ws-on]",function(cs){ci(cs,bw.Concat(o.choose(function(ct){var cu,cv,cw,cx;cu=L.SplitChars(ct,[":"],1);cv=(cw=null,[cp.TryGetValue(o.get(cu,1),{get:function(){return cw;},set:function(cy){cw=cy;}}),cw]);return cv[0]?(cx=cv[1],cx instanceof bu?{$:1,$0:bv.Handler(o.get(cu,0),cx.get_Value())}:cx instanceof I?{$:1,$0:bw.Handler(o.get(cu,0),cx.get_Value())}:(b$.warn("Event hole on"+o.get(cu,0)+" filled with non-event data",o.get(cu,1)),null)):null;},L.SplitChars(cs.getAttribute("ws-on"),[" "],1))));cs.removeAttribute("ws-on");});N.foreachNotPreserved(cb,"[ws-onafterrender]",function(cs){var ct,cu,cv,cw;ct=cs.getAttribute("ws-onafterrender");cu=(cv=null,[cp.TryGetValue(ct,{get:function(){return cv;},set:function(cx){cv=cx;}}),cv]);if(cu[0]){cw=cu[1];cw instanceof bx?(cs.removeAttribute("ws-onafterrender"),ci(cs,bv.OnAfterRender(cw.get_Value()))):cw instanceof by?(cs.removeAttribute("ws-onafterrender"),ci(cs,bv.OnAfterRender(cw.get_Value()))):b$.warn("onafterrender hole filled with non-onafterrender data",ct);}});N.foreachNotPreserved(cb,"[ws-var]",function(cs){var ct,cu,cv;ct=cs.getAttribute("ws-var");cs.removeAttribute("ws-var");cu=(cv=null,[cp.TryGetValue(ct,{get:function(){return cv;},set:function(cw){cv=cw;}}),cv]);if(cu[0])cu[1].AddAttribute(function(cw){return function(cx){return ci(cw,cx);};},cs);});N.foreachNotPreserved(cb,"[ws-attr-holes]",function(cs){var ct,cu,cv,cw;ct=new a.RegExp(N.TextHoleRE(),"g");cu=L.SplitChars(cs.getAttribute("ws-attr-holes"),[" "],1);cs.removeAttribute("ws-attr-holes");for(cv=0,cw=cu.length-1;cv<=cw;cv++)(function(){var cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ;cG=o.get(cu,cv);cH=cs.getAttribute(cG);cx=null;cy=0;cI=[];while(cx=ct.exec(cH),cx!==null){cJ=bk.string(cH,{$:1,$0:cy},{$:1,$0:ct.lastIndex-o.get(cx,0).length-1});cy=ct.lastIndex;cI.push([cJ,o.get(cx,1)]);}cA=bk.string(cH,{$:1,$0:cy},null);ct.lastIndex=0;cB=o.foldBack(function(cK,cL){return(function(cM){var cN,cO;cN=cM[0];cO=cM[1];return function(cP){var cQ,cR,cS,cT,cU;cQ=cP[0];cR=cP[1];cS=(cT=(cU=null,[cp.TryGetValue(cO,{get:function(){return cU;},set:function(cV){cU=cV;}}),cU]),cT[0]?cT[1].get_AsChoiceView():{$:0,$0:""});return cS.$==1?[cN,new _9({$:1,$0:cQ==""?cS.$0:V.Map(function(cV){return cV+cQ;},cS.$0),$1:cR})]:[cN+cS.$0+cQ,cR];};}(cK))(cL);},cI,[cA,_9.Empty]);return ci(cs,cB[1].$==1?cB[1].$1.$==1?cB[1].$1.$1.$==1?cB[1].$1.$1.$1.$==0?(cC=cB[0],bv.Dynamic(cG,V.Map3(function(cK,cL,cM){return cC+cK+cL+cM;},cB[1].$0,cB[1].$1.$0,cB[1].$1.$1.$0))):(cD=cB[0],bv.Dynamic(cG,V.Map(function(cK){return cD+L.concat("",cK);},V.Sequence(cB[1])))):(cE=cB[0],bv.Dynamic(cG,V.Map2(function(cK,cL){return cE+cK+cL;},cB[1].$0,cB[1].$1.$0))):cB[0]==""?bv.Dynamic(cG,cB[1].$0):(cF=cB[0],bv.Dynamic(cG,V.Map(function(cK){return cF+cK;},cB[1].$0))):bw.Create(cG,cB[0]));}());});return[b_.DeleteEmptyFields({Els:cd,Dirty:true,Holes:cl,Attrs:cn,Render:(cf=co.length==0?{$:1,$0:function(){ck();}}:{$:1,$0:function(cs){ck();o.iter(function(ct){ct(cs);},co);}},cf?cf.$0:void 0),El:(cg=!t.Equals(cd,null)&&cd.length===1&&(o.get(cd,0)instanceof Z&&(o.get(cd,0)instanceof bi&&(ch=o.get(cd,0),true)))?{$:1,$0:ch}:null,cg?cg.$0:void 0)},["Render","El"]),Q.TreeReduce(V.Const(),V.Map2Unit,cm)];};N.GlobalHoles=function(){bb.$cctor();return bb.GlobalHoles;};N.foreachNotPreserved=function(cb,cc,cd){bl.IterSelector(cb,cc,function(ce){if(ce.closest("[ws-preserve]")==null)cd(ce);});};N.PrepareSingleTemplate=function(cb,cc,cd){var ce;ce=N.FakeRootSingle(cd);return function(cf){N.PrepareTemplateStrict(cb,cc,ce,cf);};};N.foreachNotPreservedwsDOM=function(cb,cc){bl.IterSelectorDoc(cb,function(cd){if(cd.closest("[ws-preserve]")==null)cc(cd);});};N.TextHoleRE=function(){bb.$cctor();return bb.TextHoleRE;};O.Get=function(cb){return cb instanceof a.Array?O.ArrayEnumerator(cb):t.Equals(typeof cb,"string")?O.StringEnumerator(cb):cb.GetEnumerator();};O.ArrayEnumerator=function(cb){return new P.New(0,null,function(cc){var cd;cd=cc.s;return cd<o.length(cb)&&(cc.c=o.get(cb,cd),cc.s=cd+1,true);},void 0);};O.StringEnumerator=function(cb){return new P.New(0,null,function(cc){var cd;cd=cc.s;return cd<cb.length&&(cc.c=cb[cd],cc.s=cd+1,true);},void 0);};O.Get0=function(cb){return cb instanceof a.Array?O.ArrayEnumerator(cb):t.Equals(typeof cb,"string")?O.StringEnumerator(cb):"GetEnumerator0"in cb?cb.GetEnumerator0():cb.GetEnumerator();};P=O.T=b_.Class({Dispose:function(){if(this.d)this.d(this);},MoveNext:function(){var cb;cb=this.n(this);this.e=cb?1:2;return cb;},Current:function(){return this.e===1?this.c:this.e===0?j.FailWith("Enumeration has not started. Call MoveNext."):j.FailWith("Enumeration already finished.");}},e,P);P.New=b_.Ctor(function(cb,cc,cd,ce){e.New.call(this);this.s=cb;this.c=cc;this.n=cd;this.d=ce;this.e=0;},P);Q.ofSeqNonCopying=function(cb){var cc,cd;if(cb instanceof a.Array)return cb;else if(cb instanceof _9)return o.ofList(cb);else if(cb===null)return[];else{cc=[];cd=O.Get(cb);try{while(cd.MoveNext())cc.push(cd.Current());return cc;}finally{if(typeof cd=="object"&&"Dispose"in cd)cd.Dispose();}}};Q.TreeReduce=function(cb,cc,cd){var ce;function cf(cg){return function(ch){var ci,cj;switch(ch<=0?0:ch===1?cg>=0&&cg<ce?1:(ci=ch,2):(ci=ch,2)){case 0:return cb;case 1:return o.get(cd,cg);case 2:cj=ch/2>>0;return cc((cf(cg))(cj),(cf(cg+cj))(ch-cj));}};}ce=o.length(cd);return(cf(0))(ce);};Q.MapTreeReduce=function(cb,cc,cd,ce){var cf;function cg(ch){return function(ci){var cj,ck;switch(ci<=0?0:ci===1?ch>=0&&ch<cf?1:(cj=ci,2):(cj=ci,2)){case 0:return cc;case 1:return cb(o.get(ce,ch));case 2:ck=ci/2>>0;return cd((cg(ch))(ck),(cg(ch+ck))(ci-ck));}};}cf=o.length(ce);return(cg(0))(cf);};R=B.Text=b_.Class({get_Name:function(){return this.name;},get_Value:function(){return this.fillWith;},get_AsChoiceView:function(){return{$:0,$0:this.fillWith};}},x,R);R.New=b_.Ctor(function(cb,cc){x.New.call(this);this.name=cb;this.fillWith=cc;},R);T.Int=function(){T.set_counter(T.counter()+1);return T.counter();};T.set_counter=function(cb){bf.$cctor();bf.counter=cb;};T.counter=function(){bf.$cctor();return bf.counter;};U.InMemory=function(cb){return new _.New(cb);};V=f.View=b_.Class({},null,V);X=W.Dictionary=b_.Class({Clear:function(){this.data=[];this.count=0;},set_Item:function(cb,cc){this.set(cb,cc);},TryGetValue:function(cb,cc){var cd,ce,cf;cd=this;ce=this.data[this.hash(cb)];return ce==null?false:(cf=o.tryPick(function(cg){var ch;ch=j.KeyValue(cg);return cd.equals.apply(null,[ch[0],cb])?{$:1,$0:ch[1]}:null;},ce),cf!=null&&cf.$==1&&(cc.set(cf.$0),true));},RemoveKey:function(cb){return this.remove(cb);},set:function(cb,cc){var cd,ce,cf,cg;cd=this;ce=this.hash(cb);cf=this.data[ce];if(cf==null){this.count=this.count+1;this.data[ce]=new a.Array({K:cb,V:cc});}else{cg=o.tryFindIndex(function(ch){return cd.equals.apply(null,[(j.KeyValue(ch))[0],cb]);},cf);cg==null?(this.count=this.count+1,cf.push({K:cb,V:cc})):cf[cg.$0]={K:cb,V:cc};}},ContainsKey:function(cb){var cc,cd;cc=this;cd=this.data[this.hash(cb)];return cd==null?false:o.exists(function(ce){return cc.equals.apply(null,[(j.KeyValue(ce))[0],cb]);},cd);},Keys:function(){return new bm.New(this);},GetEnumerator:function(){return O.Get0(o.concat(_0.GetFieldValues(this.data)));},remove:function(cb){var cc,cd,ce,cf;cc=this;cd=this.hash(cb);ce=this.data[cd];return ce==null?false:(cf=o.filter(function(cg){return!cc.equals.apply(null,[(j.KeyValue(cg))[0],cb]);},ce),o.length(cf)<ce.length&&(this.count=this.count-1,this.data[cd]=cf,true));},Values:function(){return new bA.New(this);},Item:function(cb){return this.get(cb);},get:function(cb){var cc,cd;cc=this;cd=this.data[this.hash(cb)];return cd==null?$.notPresent():o.pick(function(ce){var cf;cf=j.KeyValue(ce);return cc.equals.apply(null,[cf[0],cb])?{$:1,$0:cf[1]}:null;},cd);}},e,X);X.New$5=b_.Ctor(function(){X.New$6.call(this,[],t.Equals,t.Hash);},X);X.New$6=b_.Ctor(function(cb,cc,cd){var ce,cf;e.New.call(this);this.equals=cc;this.hash=cd;this.count=0;this.data=[];ce=O.Get(cb);try{while(ce.MoveNext()){cf=ce.Current();this.set(cf.K,cf.V);}}finally{if(typeof ce=="object"&&"Dispose"in ce)ce.Dispose();}},X);z.Obsolete=function(cb){var cc,cd,ce,cf,cg;cd=cb.s;if(cd==null||(cd!=null&&cd.$==2?(cc=cd.$1,false):cd!=null&&cd.$==3?(cc=cd.$1,false):true))void 0;else{cb.s=null;for(ce=0,cf=o.length(cc)-1;ce<=cf;ce++){cg=o.get(cc,ce);if(typeof cg=="object")(function(ch){z.Obsolete(ch);}(cg));else cg();}}};z.New=function(cb){return{s:cb};};_0.GetFieldValues=function(cb){var cc,cd;cc=[];for(var ce in cb)cc.push(cb[ce]);return cc;};_1=W.HashSet=b_.Class({SAdd:function(cb){return this.add(cb);},Contains:function(cb){var cc;cc=this.data[this.hash(cb)];return cc==null?false:this.arrContains(cb,cc);},add:function(cb){var cc,cd;cc=this.hash(cb);cd=this.data[cc];return cd==null?(this.data[cc]=[cb],this.count=this.count+1,true):this.arrContains(cb,cd)?false:(cd.push(cb),this.count=this.count+1,true);},arrContains:function(cb,cc){var cd,ce,cf,cg;cd=true;ce=0;cg=cc.length;while(cd&&ce<cg)if(this.equals.apply(null,[cc[ce],cb]))cd=false;else ce=ce+1;return!cd;},GetEnumerator:function(){return O.Get(bH.concat(this.data));},ExceptWith:function(cb){var cc;cc=O.Get(cb);try{while(cc.MoveNext())this.Remove(cc.Current());}finally{if(typeof cc=="object"&&"Dispose"in cc)cc.Dispose();}},Count:function(){return this.count;},IntersectWith:function(cb){var cc,cd,ce,cf,cg;cc=new _1.New$4(cb,this.equals,this.hash);cd=bH.concat(this.data);for(ce=0,cf=cd.length-1;ce<=cf;ce++){cg=cd[ce];if(!cc.Contains(cg))this.Remove(cg);}},Remove:function(cb){var cc;cc=this.data[this.hash(cb)];return cc==null?false:this.arrRemove(cb,cc)&&(this.count=this.count-1,true);},CopyTo:function(cb,cc){var cd,ce,cf;cd=bH.concat(this.data);for(ce=0,cf=cd.length-1;ce<=cf;ce++)o.set(cb,ce+cc,cd[ce]);},arrRemove:function(cb,cc){var cd,ce,cf,cg;cd=true;ce=0;cg=cc.length;while(cd&&ce<cg)if(this.equals.apply(null,[cc[ce],cb])){cc.splice.apply(cc,[ce,1]);cd=false;}else ce=ce+1;return!cd;}},e,_1);_1.New$3=b_.Ctor(function(){_1.New$4.call(this,[],t.Equals,t.Hash);},_1);_1.New$4=b_.Ctor(function(cb,cc,cd){var ce;e.New.call(this);this.equals=cc;this.hash=cd;this.data=[];this.count=0;ce=O.Get(cb);try{while(ce.MoveNext())this.add(ce.Current());}finally{if(typeof ce=="object"&&"Dispose"in ce)ce.Dispose();}},_1);_1.New$2=b_.Ctor(function(cb){_1.New$4.call(this,cb,t.Equals,t.Hash);},_1);_2.$cctor=function(){_2.$cctor=a.ignore;_2.initialized=new X.New$5();};_2=m.TemplateInitializer=b_.Class({},e,_2);_2.GetOrAddHoleFor=function(cb,cc,cd){var ce,cf,cg,ch;_2.$cctor();ce=_2.GetHolesFor(cb);cf=(cg=null,[ce.TryGetValue(cc,{get:function(){return cg;},set:function(ci){cg=ci;}}),cg]);return cf[0]?cf[1]:(ch=cd(),(ce.set_Item(cc,ch),ch));};_2.GetHolesFor=function(cb){var cc,cd,ce;_2.$cctor();cc=(cd=null,[_2.initialized.TryGetValue(cb,{get:function(){return cd;},set:function(cf){cd=cf;}}),cd]);return cc[0]?cc[1]:(ce=new X.New$5(),(_2.initialized.set_Item(cb,ce),ce));};_3=B.VarFloatUnchecked=b_.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:V.Map(b9,this.fillWith.get_View())};},AddAttribute:function(cb,cc){(cb(cc))(bv.FloatValueUnchecked(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:V.Map(b9,this.fillWith.get_View())};}},x,_3);_3.New=b_.Ctor(function(cb,cc){x.New.call(this);this.name=cb;this.fillWith=cc;},_3);_4=B.VarBool=b_.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:V.Map(b9,this.fillWith.get_View())};},AddAttribute:function(cb,cc){(cb(cc))(bv.Checked(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:V.Map(b9,this.fillWith.get_View())};}},x,_4);_4.New=b_.Ctor(function(cb,cc){x.New.call(this);this.name=cb;this.fillWith=cc;},_4);_5=B.VarDateTime=b_.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:V.Map(function(cb){return(new b8(cb)).toLocaleString();},this.fillWith.get_View())};},AddAttribute:function(cb,cc){(cb(cc))(bv.DateTimeValue(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:V.Map(function(cb){return(new b8(cb)).toLocaleString();},this.fillWith.get_View())};}},x,_5);_5.New=b_.Ctor(function(cb,cc){x.New.call(this);this.name=cb;this.fillWith=cc;},_5);_6=B.VarFile=b_.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:V.Map(b9,this.fillWith.get_View())};},AddAttribute:function(cb,cc){(cb(cc))(bv.FileValue(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:V.Map(b9,this.fillWith.get_View())};}},x,_6);_6.New=b_.Ctor(function(cb,cc){x.New.call(this);this.name=cb;this.fillWith=cc;},_6);_7=B.VarDomElement=b_.Class({get_Name:function(){return this.name;},get_Value:function(){return this.fillWith;}},x,_7);_7.New=b_.Ctor(function(cb,cc){x.New.call(this);this.name=cb;this.fillWith=cc;},_7);_9=_8.T=b_.Class({GetEnumerator:function(){return new P.New(this,null,function(cb){var cc;cc=cb.s;return cc.$==0?false:(cb.c=cc.$0,cb.s=cc.$1,true);},void 0);}},null,_9);_9.Empty=new _9({$:0});o.mapiInPlace=function(cb,cc){var cd,ce;for(cd=0,ce=cc.length-1;cd<=ce;cd++)cc[cd]=cb(cd,cc[cd]);return cc;};o.mapInPlace=function(cb,cc){var cd,ce;for(cd=0,ce=cc.length-1;cd<=ce;cd++)cc[cd]=cb(cc[cd]);};v.insufficient=function(){return j.FailWith("The input sequence has an insufficient number of elements.");};v.nonNegative=function(){return j.FailWith("The input must be non-negative.");};V.Map2Unit=function(cb,cc){return V.CreateLazy(function(){return z.Map2Unit(cb(),cc());});};V.Const=function(cb){var cc;cc=z.New({$:0,$0:cb});return function(){return cc;};};V.Map=function(cb,cc){return V.CreateLazy(function(){return z.Map(cb,cc());});};V.CreateLazy=function(cb){var cc;cc={c:null,o:cb};return function(){var cd,ce;cd=cc.c;return cd===null?(cd=cc.o(),cc.c=cd,(ce=cd.s,ce!=null&&ce.$==0)?cc.o=null:z.WhenObsoleteRun(cd,function(){cc.c=null;}),cd):cd;};};V.Sink=function(cb,cc){function cd(){z.WhenRun(cc(),cb,function(){bE.scheduler().Fork(cd);});}bE.scheduler().Fork(cd);};V.Bind=function(cb,cc){return V.Join(V.Map(cb,cc));};V.Map3=function(cb,cc,cd,ce){return V.CreateLazy(function(){return z.Map3(cb,cc(),cd(),ce());});};V.Sequence=function(cb){return V.CreateLazy(function(){return z.Sequence(v.map(function(cc){return cc();},cb));});};V.Map2=function(cb,cc,cd){return V.CreateLazy(function(){return z.Map2(cb,cc(),cd());});};V.Join=function(cb){return V.CreateLazy(function(){return z.Join(cb());});};_=U.ArrayStorage=b_.Class({SSet:function(cb){return o.ofSeq(cb);},SSetAt:function(cb,cc,cd){o.set(cd,cb,cc);return cd;},SAppend:function(cb,cc){cc.push(cb);return cc;},SInit:function(){return this.init;}},e,_);_.New=b_.Ctor(function(cb){e.New.call(this);this.init=cb;},_);$.notPresent=function(){throw new bN.New();};bb.$cctor=function(){bb.$cctor=a.ignore;bb.LoadedTemplates=new X.New$5();bb.LocalTemplatesLoaded=false;bb.GlobalHoles=new X.New$5();bb.TextHoleRE="\\${([^}]+)}";bb.RenderedFullDocTemplate=null;};bc.LinkElement=function(cb,cc){bc.InsertDoc(cb,cc,null);};bc.InsertDoc=function(cb,cc,cd){var ce,cf,cg;while(true)if(cc!=null&&cc.$==1)return bc.InsertNode(cb,cc.$0.El,cd);else if(cc!=null&&cc.$==2){ce=cc.$0;ce.Dirty=false;cc=ce.Current;}else if(cc==null)return cd;else if(cc!=null&&cc.$==4)return bc.InsertNode(cb,cc.$0.Text,cd);else if(cc!=null&&cc.$==5)return bc.InsertNode(cb,cc.$0,cd);else if(cc!=null&&cc.$==6)return o.foldBack(function(ch,ci){return(((b_.Curried3(function(cj,ck,cl){return ck==null||ck.constructor===s?bc.InsertDoc(cj,ck,cl):bc.InsertNode(cj,ck,cl);}))(cb))(ch))(ci);},cc.$0.Els,cd);else{cf=cc.$1;cg=cc.$0;cc=cg;cd=bc.InsertDoc(cb,cf,cd);}};bc.CreateRunState=function(cb,cc){return bC.New(bD.get_Empty(),bc.CreateElemNode(cb,bs.EmptyAttr(),cc));};bc.PerformAnimatedUpdate=function(cb,cc,cd){var ce;return bn.get_UseAnimations()?(ce=null,bE.Delay(function(){var cf,cg,ch;cf=bD.FindAll(cd);cg=bc.ComputeChangeAnim(cc,cf);ch=bc.ComputeEnterAnim(cc,cf);return bE.Bind(bn.Play(bn.Append(cg,bc.ComputeExitAnim(cc,cf))),function(){return bE.Bind(bc.SyncElemNodesNextFrame(cb,cc),function(){return bE.Bind(bn.Play(ch),function(){cc.PreviousNodes=cf;return bE.Return(null);});});});})):bc.SyncElemNodesNextFrame(cb,cc);};bc.PerformSyncUpdate=function(cb,cc,cd){var ce;ce=bD.FindAll(cd);bc.SyncElemNode(cb,cc.Top);cc.PreviousNodes=ce;};bc.CreateEmbedNode=function(){return{Current:null,Dirty:false};};bc.UpdateEmbedNode=function(cb,cc){cb.Current=cc;cb.Dirty=true;};bc.InsertBeforeDelim=function(cb,cc){var cd,ce;cd=cb.parentNode;ce=self.document.createTextNode("");cd.insertBefore(ce,cb);bc.LinkPrevElement(cb,cc);return ce;};bc.InsertNode=function(cb,cc,cd){bl.InsertAt(cb,cd,cc);return cc;};bc.CreateElemNode=function(cb,cc,cd){var ce;bc.LinkElement(cb,cd);ce=bs.Insert(cb,cc);return bd.New(ce,cd,null,cb,T.Int(),b_.GetOptional(ce.OnAfterRender));};bc.SyncElemNodesNextFrame=function(cb,cc){function cd(ce){a.requestAnimationFrame(function(){bc.SyncElemNode(cb,cc.Top);ce();});}return bo.BatchUpdatesEnabled()?bE.FromContinuations(function(ce,cf,cg){return cd.apply(null,[ce,cf,cg]);}):(bc.SyncElemNode(cb,cc.Top),bE.Return(null));};bc.ComputeExitAnim=function(cb,cc){return bn.Concat(o.map(function(cd){return bs.GetExitAnim(cd.Attr);},bD.ToArray(bD.Except(cc,bD.Filter(function(cd){return bs.HasExitAnim(cd.Attr);},cb.PreviousNodes)))));};bc.ComputeEnterAnim=function(cb,cc){return bn.Concat(o.map(function(cd){return bs.GetEnterAnim(cd.Attr);},bD.ToArray(bD.Except(cb.PreviousNodes,bD.Filter(function(cd){return bs.HasEnterAnim(cd.Attr);},cc)))));};bc.ComputeChangeAnim=function(cb,cc){var cd;function ce(cf){return bs.HasChangeAnim(cf.Attr);}cd=function(cf){return bD.Filter(ce,cf);};return bn.Concat(o.map(function(cf){return bs.GetChangeAnim(cf.Attr);},bD.ToArray(bD.Intersect(cd(cb.PreviousNodes),cd(cc)))));};bc.SyncElemNode=function(cb,cc){!cb?bc.SyncElement(cc):void 0;bc.Sync(cc.Children);bc.AfterRender(cc);};bc.CreateTextNode=function(){return{Text:self.document.createTextNode(""),Dirty:false,Value:""};};bc.UpdateTextNode=function(cb,cc){cb.Value=cc;cb.Dirty=true;};bc.LinkPrevElement=function(cb,cc){bc.InsertDoc(cb.parentNode,cc,cb);};bc.SyncElement=function(cb){function cc(cd){function ce(cf){var cg,ch,ci,cj;while(true){if(cf!=null&&cf.$==0){ch=cf.$1;ci=cf.$0;if(ce(ci))return true;else cf=ch;}else if(cf!=null&&cf.$==2){cj=cf.$0;if(cj.Dirty)return true;else cf=cj.Current;}else return cf!=null&&cf.$==6&&(cg=cf.$0,cg.Dirty||o.exists(cc,cg.Holes));}}return ce(cd.Children);}bs.Sync(cb.El,cb.Attr);if(cc(cb))bc.DoSyncElement(cb);};bc.Sync=function(cb){var cc,cd,ce,cf,cg;while(true){if(cb!=null&&cb.$==1)return bc.SyncElemNode(false,cb.$0);else if(cb!=null&&cb.$==2){ce=cb.$0;cb=ce.Current;}else if(cb==null)return null;else if(cb!=null&&cb.$==5)return null;else if(cb!=null&&cb.$==4){cc=cb.$0;return cc.Dirty?(cc.Text.nodeValue=cc.Value,cc.Dirty=false):null;}else if(cb!=null&&cb.$==6){cd=cb.$0;o.iter(function(ch){bc.SyncElemNode(false,ch);},cd.Holes);o.iter(function(ch){bs.Sync(ch[0],ch[1]);},cd.Attrs);return bc.AfterRender(cd);}else{cf=cb.$1;cg=cb.$0;bc.Sync(cg);cb=cf;}}};bc.AfterRender=function(cb){var cc;cc=b_.GetOptional(cb.Render);if(cc!=null&&cc.$==1){cc.$0(cb.El);b_.SetOptional(cb,"Render",null);}};bc.DoSyncElement=function(cb){var cc,cd,ce;function cf(cg,ch){var ci,cj,ck,cl;while(true){if(cg!=null&&cg.$==1)return cg.$0.El;else if(cg!=null&&cg.$==2){cj=cg.$0;if(cj.Dirty){cj.Dirty=false;return bc.InsertDoc(cc,cj.Current,ch);}else cg=cj.Current;}else if(cg==null)return ch;else if(cg!=null&&cg.$==4)return cg.$0.Text;else if(cg!=null&&cg.$==5)return cg.$0;else if(cg!=null&&cg.$==6){ci=cg.$0;ci.Dirty?ci.Dirty=false:void 0;return o.foldBack(function(cm,cn){return cm==null||cm.constructor===s?cf(cm,cn):cm;},ci.Els,ch);}else{ck=cg.$1;cl=cg.$0;cg=cl;ch=cf(ck,ch);}}}cc=cb.El;b0.Iter((cd=cb.El,function(cg){bl.RemoveNode(cd,cg);}),b0.Except(b0.DocChildren(cb),b0.Children(cb.El,b_.GetOptional(cb.Delimiters))));cf(cb.Children,(ce=b_.GetOptional(cb.Delimiters),ce!=null&&ce.$==1?ce.$0[1]:null));};_8.head=function(cb){return cb.$==1?cb.$0:_8.listEmpty();};_8.tail=function(cb){return cb.$==1?cb.$1:_8.listEmpty();};_8.listEmpty=function(){return j.FailWith("The input list was empty.");};bd=f.DocElemNode=b_.Class({Equals:function(cb){return this.ElKey===cb.ElKey;},GetHashCode:function(){return this.ElKey;}},null,bd);bd.New=function(cb,cc,cd,ce,cf,cg){var ch;return new bd((ch={Attr:cb,Children:cc,El:ce,ElKey:cf},(b_.SetOptional(ch,"Delimiters",cd),b_.SetOptional(ch,"Render",cg),ch)));};bf.$cctor=function(){bf.$cctor=a.ignore;bf.counter=0;};bh=f.Elt=b_.Class({},w,bh);bh.TreeNode=function(cb,cc){var cd,ce;function cf(cg,ch){return bs.Updates(ch);}cd=bz.Create(cc);return new bh.New$1({$:6,$0:cb},V.Map2Unit((ce=o.map(function(cg){return cf(cg[0],cg[1]);},cb.Attrs),Q.TreeReduce(V.Const(),V.Map2Unit,ce)),cd.v),o.get(cb.Els,0),cd);};bh.New$1=b_.Ctor(function(cb,cc,cd,ce){w.New.call(this,cb,cc);this.docNode$1=cb;this.updates$1=cc;this.elt=cd;this.rvUpdates=ce;},bh);bj.convertTextNode=function(cb){var cc,cd,ce,cf,cg,ch;cc=null;cd=0;cf=cb.textContent;cg=new a.RegExp(N.TextHoleRE(),"g");while(cc=cg.exec(cf),cc!==null){cb.parentNode.insertBefore(self.document.createTextNode(bk.string(cf,{$:1,$0:cd},{$:1,$0:cg.lastIndex-o.get(cc,0).length-1})),cb);cd=cg.lastIndex;ch=self.document.createElement("span");ch.setAttribute("ws-replace",o.get(cc,1).toLowerCase());cb.parentNode.insertBefore(ch,cb);}cg.lastIndex=0;cb.textContent=bk.string(cf,{$:1,$0:cd},null);};bj.failNotLoaded=function(cb){b$.warn("Instantiating non-loaded template",cb);};bj.fillTextHole=function(cb,cc,cd){var ce;ce=cb.querySelector("[ws-replace]");return t.Equals(ce,null)?(b$.warn("Filling non-existent text hole",cd),null):(ce.parentNode.replaceChild(self.document.createTextNode(cc),ce),{$:1,$0:ce.getAttribute("ws-replace")});};bj.removeHolesExcept=function(cb,cc){function cd(ce){N.foreachNotPreserved(cb,"["+ce+"]",function(cf){if(!cc.Contains(cf.getAttribute(ce)))cf.removeAttribute(ce);});}cd("ws-attr");cd("ws-onafterrender");cd("ws-var");N.foreachNotPreserved(cb,"[ws-hole]",function(ce){if(!cc.Contains(ce.getAttribute("ws-hole"))){ce.removeAttribute("ws-hole");while(ce.hasChildNodes())ce.removeChild(ce.lastChild);}});N.foreachNotPreserved(cb,"[ws-replace]",function(ce){if(!cc.Contains(ce.getAttribute("ws-replace")))ce.parentNode.removeChild(ce);});N.foreachNotPreserved(cb,"[ws-on]",function(ce){ce.setAttribute("ws-on",L.concat(" ",o.filter(function(cf){return cc.Contains(o.get(L.SplitChars(cf,[":"],1),1));},L.SplitChars(ce.getAttribute("ws-on"),[" "],1))));});N.foreachNotPreserved(cb,"[ws-attr-holes]",function(ce){var cf,cg,ch,ci,cj;cf=L.SplitChars(ce.getAttribute("ws-attr-holes"),[" "],1);for(cg=0,ch=cf.length-1;cg<=ch;cg++){ci=o.get(cf,cg);ce.setAttribute(ci,(cj=new a.RegExp(N.TextHoleRE(),"g"),ce.getAttribute(ci).replace(cj,function(ck,cl){return cc.Contains(cl)?ck:"";})));}});};bj.fillInstanceAttrs=function(cb,cc){var cd,ce,cf,cg,ch;bj.convertAttrs(cc);cd=cc.nodeName.toLowerCase();ce=cb.querySelector("[ws-attr="+cd+"]");if(t.Equals(ce,null))b$.warn("Filling non-existent attr hole",cd);else{ce.removeAttribute("ws-attr");for(cf=0,cg=cc.attributes.length-1;cf<=cg;cf++){ch=cc.attributes.item(cf);if(ch.name=="class"&&ce.hasAttribute("class"))ce.setAttribute("class",ce.getAttribute("class")+" "+ch.nodeValue);else ce.setAttribute(ch.name,ch.nodeValue);}}};bj.mapHoles=function(cb,cc){function cd(ce){N.foreachNotPreserved(cb,"["+ce+"]",function(cf){var cg,ch;cg=(ch=null,[cc.TryGetValue(cf.getAttribute(ce).toLowerCase(),{get:function(){return ch;},set:function(ci){ch=ci;}}),ch]);if(cg[0])cf.setAttribute(ce,cg[1]);});}cd("ws-hole");cd("ws-replace");cd("ws-attr");cd("ws-onafterrender");cd("ws-var");N.foreachNotPreserved(cb,"[ws-on]",function(ce){ce.setAttribute("ws-on",L.concat(" ",o.map(function(cf){var cg,ch,ci;cg=L.SplitChars(cf,[":"],1);ch=(ci=null,[cc.TryGetValue(o.get(cg,1),{get:function(){return ci;},set:function(cj){ci=cj;}}),ci]);return ch[0]?o.get(cg,0)+":"+ch[1]:cf;},L.SplitChars(ce.getAttribute("ws-on"),[" "],1))));});N.foreachNotPreserved(cb,"[ws-attr-holes]",function(ce){var cf,cg,ch;cf=L.SplitChars(ce.getAttribute("ws-attr-holes"),[" "],1);for(cg=0,ch=cf.length-1;cg<=ch;cg++)(function(){var ci;function cj(ck,cl){var cm;cm=j.KeyValue(cl);return ck.replace(new a.RegExp("\\${"+cm[0]+"}","ig"),"${"+cm[1]+"}");}ci=o.get(cf,cg);return ce.setAttribute(ci,(((b_.Curried3(v.fold))(cj))(ce.getAttribute(ci)))(cc));}());});};bj.fill=function(cb,cc,cd){while(true)if(cb.hasChildNodes())cd=cc.insertBefore(cb.lastChild,cd);else return null;};bj.convertAttrs=function(cb){var cd,ce,cf,cg,ch,ci,cj,ck;function cc(cl){var cm;cm=cb.getAttribute(cl);if(cm==null);else cb.setAttribute(cl,cm.toLowerCase());}cd=cb.attributes;ce=[];cf=[];cg=[];for(ch=0,ci=cd.length-1;ch<=ci;ch++){cj=cd.item(ch);if(L.StartsWith(cj.nodeName,"ws-on")&&cj.nodeName!="ws-onafterrender"&&cj.nodeName!="ws-on"){ce.push(cj.nodeName);cf.push(bk.string(cj.nodeName,{$:1,$0:"ws-on".length},null)+":"+cj.nodeValue.toLowerCase());}else!L.StartsWith(cj.nodeName,"ws-")&&(new a.RegExp(N.TextHoleRE())).test(cj.nodeValue)?(cj.nodeValue=(ck=new a.RegExp(N.TextHoleRE(),"g"),cj.nodeValue.replace(ck,function(cl,cm){return"${"+cm.toLowerCase()+"}";})),cg.push(cj.nodeName)):void 0;}if(!(cf.length==0))cb.setAttribute("ws-on",L.concat(" ",cf));if(!(cg.length==0))cb.setAttribute("ws-attr-holes",L.concat(" ",cg));cc("ws-hole");cc("ws-replace");cc("ws-attr");cc("ws-onafterrender");cc("ws-var");o.iter(function(cl){cb.removeAttribute(cl);},ce);};bk.string=function(cb,cc,cd){var ce,cf;return cc==null?cd!=null&&cd.$==1?(ce=cd.$0,ce<0?"":cb.slice(0,ce+1)):"":cd==null?cb.slice(cc.$0):(cf=cd.$0,cf<0?"":cb.slice(cc.$0,cf+1));};bl.ParseHTMLIntoFakeRoot=function(cb){var cc,cd,ce,cf,cg;function ch(ci,cj){var ck;while(true)if(cj===0)return ci;else{ck=cj;ci=ci.lastChild;cj=ck-1;}}cc=self.document.createElement("div");return!bl.rhtml().test(cb)?(cc.appendChild(self.document.createTextNode(cb)),cc):(cd=(ce=bl.rtagName().exec(cb),t.Equals(ce,null)?"":o.get(ce,1).toLowerCase()),(cf=(cg=(bl.wrapMap())[cd],cg?cg:bl.defaultWrap()),(cc.innerHTML=cf[1]+cb.replace(bl.rxhtmlTag(),"<$1></$2>")+cf[2],ch(cc,cf[0]))));};bl.ChildrenArray=function(cb){var cc,cd,ce;cc=[];for(cd=0,ce=cb.childNodes.length-1;cd<=ce;cd++)cc.push(cb.childNodes[cd]);return cc;};bl.rhtml=function(){bI.$cctor();return bI.rhtml;};bl.wrapMap=function(){bI.$cctor();return bI.wrapMap;};bl.defaultWrap=function(){bI.$cctor();return bI.defaultWrap;};bl.rxhtmlTag=function(){bI.$cctor();return bI.rxhtmlTag;};bl.rtagName=function(){bI.$cctor();return bI.rtagName;};bl.IterSelector=function(cb,cc,cd){var ce,cf,cg;ce=cb.querySelectorAll(cc);for(cf=0,cg=ce.length-1;cf<=cg;cf++)cd(ce[cf]);};bl.IterSelectorDoc=function(cb,cc){var cd,ce,cf;cd=self.document.querySelectorAll(cb);for(ce=0,cf=cd.length-1;ce<=cf;ce++)cc(cd[ce]);};bl.InsertAt=function(cb,cc,cd){var ce;if(!(cd.parentNode===cb&&cc===(ce=cd.nextSibling,t.Equals(ce,null)?null:ce)))cb.insertBefore(cd,cc);};bl.RemoveNode=function(cb,cc){if(cc.parentNode===cb)cb.removeChild(cc);};bm=W.KeyCollection=b_.Class({GetEnumerator:function(){return O.Get(v.map(function(cb){return cb.K;},this.d));}},e,bm);bm.New=b_.Ctor(function(cb){e.New.call(this);this.d=cb;},bm);bn.get_UseAnimations=function(){return bF.UseAnimations();};bn.Play=function(cb){var cc;cc=null;return bE.Delay(function(){return bE.Bind(bn.Run(a.ignore,bF.Actions(cb)),function(){bF.Finalize(cb);return bE.Return(null);});});};bn.Append=function(cb,cc){return{$:0,$0:bK.Append(cb.$0,cc.$0)};};bn.Run=function(cb,cc){var cd;function ce(cf){function cg(ch){return function(ci){var cj;cj=ci-ch;cc.Compute(cj);cb();return cj<=cd?void a.requestAnimationFrame(function(ck){(cg(ch))(ck);}):cf();};}a.requestAnimationFrame(function(ch){(cg(ch))(ch);});}cd=cc.Duration;return cd===0?bE.Zero():bE.FromContinuations(function(cf,cg,ch){return ce.apply(null,[cf,cg,ch]);});};bn.Concat=function(cb){return{$:0,$0:bK.Concat(v.map(bF.List,cb))};};bn.get_Empty=function(){return{$:0,$0:bK.Empty()};};bo.BatchUpdatesEnabled=function(){bG.$cctor();return bG.BatchUpdatesEnabled;};bp.StartProcessor=function(cb){var cc;function cd(){var ce;ce=null;return bE.Delay(function(){return bE.Bind(cb,function(){var cf;cf=cc[0];return t.Equals(cf,1)?(cc[0]=0,bE.Zero()):t.Equals(cf,2)?(cc[0]=1,cd()):bE.Zero();});});}cc=[0];return function(){var ce;ce=cc[0];if(t.Equals(ce,0)){cc[0]=1;bE.Start(cd(),null);}else t.Equals(ce,1)?cc[0]=2:void 0;};};br.New=function(cb,cc,cd,ce){var cf;cf={DynElem:cb,DynFlags:cc,DynNodes:cd};b_.SetOptional(cf,"OnAfterRender",ce);return cf;};bs.Insert=function(cb,cc){var cd,ce,cf;function cg(ch){var ci,cj;while(true)if(!(ch===null)){if(ch!=null&&ch.$==1)return cd.push(ch.$0);else if(ch!=null&&ch.$==2){ci=ch.$1;cj=ch.$0;cg(cj);ch=ci;}else return ch!=null&&ch.$==3?ch.$0(cb):ch!=null&&ch.$==4?ce.push(ch.$0):null;}else return null;}cd=[];ce=[];cg(cc);cf=cd.slice(0);return br.New(cb,bs.Flags(cc),cf,ce.length===0?null:{$:1,$0:function(ch){v.iter(function(ci){ci(ch);},ce);}});};bs.Updates=function(cb){return Q.MapTreeReduce(function(cc){return cc.NChanged();},V.Const(),V.Map2Unit,cb.DynNodes);};bs.Empty=function(cb){return br.New(cb,0,[],null);};bs.Flags=function(cb){return cb!==null&&cb.hasOwnProperty("flags")?cb.flags:0;};bs.Static=function(cb){return new bw({$:3,$0:cb});};bs.Dynamic=function(cb,cc){return new bw({$:1,$0:new bL.New(cb,cc)});};bs.EmptyAttr=function(){bO.$cctor();return bO.EmptyAttr;};bs.HasExitAnim=function(cb){var cc;cc=2;return(cb.DynFlags&cc)===cc;};bs.GetExitAnim=function(cb){return bs.GetAnim(cb,function(cc,cd){return cc.NGetExitAnim(cd);});};bs.HasEnterAnim=function(cb){var cc;cc=1;return(cb.DynFlags&cc)===cc;};bs.GetEnterAnim=function(cb){return bs.GetAnim(cb,function(cc,cd){return cc.NGetEnterAnim(cd);});};bs.HasChangeAnim=function(cb){var cc;cc=4;return(cb.DynFlags&cc)===cc;};bs.GetChangeAnim=function(cb){return bs.GetAnim(cb,function(cc,cd){return cc.NGetChangeAnim(cd);});};bs.AppendTree=function(cb,cc){var cd;return cb===null?cc:cc===null?cb:(cd=new bw({$:2,$0:cb,$1:cc}),(bs.SetFlags(cd,bs.Flags(cb)|bs.Flags(cc)),cd));};bs.GetAnim=function(cb,cc){return bn.Concat(o.map(function(cd){return cc(cd,cb.DynElem);},cb.DynNodes));};bs.Sync=function(cb,cc){o.iter(function(cd){cd.NSync(cb);},cc.DynNodes);};bs.SetFlags=function(cb,cc){cb.flags=cc;};bt=B.Attribute=b_.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},x,bt);bu=B.Event=b_.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},x,bu);bv.Handler=function(cb,cc){return bs.Static(function(cd){cd.addEventListener(cb,function(ce){return(cc(cd))(ce);},false);});};bv.OnAfterRender=function(cb){return new bw({$:4,$0:cb});};bv.Dynamic=function(cb,cc){return bs.Dynamic(cc,function(cd){return function(ce){return cd.setAttribute(cb,ce);};});};bv.Value=function(cb){return bv.ValueWith(bW.StringApply(),cb);};bv.IntValueUnchecked=function(cb){return bv.ValueWith(bW.IntApplyUnchecked(),cb);};bv.FloatValueUnchecked=function(cb){return bv.ValueWith(bW.FloatApplyUnchecked(),cb);};bv.Checked=function(cb){return bv.ValueWith(bW.BoolCheckedApply(),cb);};bv.DateTimeValue=function(cb){return bv.ValueWith(bW.DateTimeApplyUnchecked(),cb);};bv.FileValue=function(cb){return bv.ValueWith(bW.FileApplyUnchecked(),cb);};bv.ValueWith=function(cb,cc){var cd;cd=cb(cc);return bw.Append(bs.Static(cd[0]),bv.DynamicCustom(cd[1],cd[2]));};bv.DynamicCustom=function(cb,cc){return bs.Dynamic(cc,cb);};bw=f.AttrProxy=b_.Class({},null,bw);bw.Handler=function(cb,cc){return bw.HandlerImpl(cb,cc);};bw.Concat=function(cb){var cc;cc=Q.ofSeqNonCopying(cb);return Q.TreeReduce(bs.EmptyAttr(),bw.Append,cc);};bw.Create=function(cb,cc){return bs.Static(function(cd){cd.setAttribute(cb,cc);});};bw.HandlerImpl=function(cb,cc){return bs.Static(function(cd){cd.addEventListener(cb,function(ce){return(cc(cd))(ce);},false);});};bw.Append=function(cb,cc){return bs.AppendTree(cb,cc);};bx=B.AfterRender=b_.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},x,bx);by=B.AfterRenderQ=b_.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},x,by);bz=f.Updates=b_.Class({},null,bz);bz.Create=function(cb){var cc;cc=null;cc=bz.New(cb,null,function(){var cd;cd=cc.s;return cd===null?(cd=z.Copy(cc.c()),cc.s=cd,z.WhenObsoleteRun(cd,function(){cc.s=null;}),cd):cd;});return cc;};bz.New=function(cb,cc,cd){return new bz({c:cb,s:cc,v:cd});};bA=W.ValueCollection=b_.Class({GetEnumerator:function(){return O.Get(v.map(function(cb){return cb.V;},this.d));}},e,bA);bA.New=b_.Ctor(function(cb){e.New.call(this);this.d=cb;},bA);bC.New=function(cb,cc){return{PreviousNodes:cb,Top:cc};};bD.get_Empty=function(){return{$:0,$0:new _1.New$3()};};bD.FindAll=function(cb){var cc;function cd(cg,ch){var ci,cj,ck,cl,cm;while(true)switch(cg){case 0:if(ch!=null&&ch.$==0){cj=ch.$1;ck=ch.$0;cd(0,ck);ch=cj;}else if(ch!=null&&ch.$==1){cl=ch.$0;ch=cl;cg=1;}else if(ch!=null&&ch.$==2){cm=ch.$0;ch=cm.Current;}else return ch!=null&&ch.$==6?(ci=ch.$0.Holes,(function(cn){return function(co){o.iter(cn,co);};}(cf))(ci)):null;break;case 1:cc.push(ch);ch=ch.Children;cg=0;break;}}function ce(cg){return cd(0,cg);}function cf(cg){return cd(1,cg);}cc=[];ce(cb);return{$:0,$0:new _1.New$2(cc)};};bD.Filter=function(cb,cc){return{$:0,$0:bU.Filter(cb,cc.$0)};};bD.Except=function(cb,cc){return{$:0,$0:bU.Except(cb.$0,cc.$0)};};bD.ToArray=function(cb){return bU.ToArray(cb.$0);};bD.Intersect=function(cb,cc){return{$:0,$0:bU.Intersect(cb.$0,cc.$0)};};bE.Delay=function(cb){return function(cc){try{(cb(null))(cc);}catch(cd){cc.k({$:1,$0:cd});}};};bE.Bind=function(cb,cc){return bE.checkCancel(function(cd){cb(bR.New(function(ce){var cf;if(ce.$==0){cf=ce.$0;bE.scheduler().Fork(function(){try{(cc(cf))(cd);}catch(cg){cd.k({$:1,$0:cg});}});}else bE.scheduler().Fork(function(){cd.k(ce);});},cd.ct));});};bE.Zero=function(){bS.$cctor();return bS.Zero;};bE.Start=function(cb,cc){var cd,ce;cd=(ce=(bE.defCTS())[0],cc==null?ce:cc.$0);bE.scheduler().Fork(function(){if(!cd.c)cb(bR.New(function(cf){if(cf.$==1)bE.UncaughtAsyncError(cf.$0);},cd));});};bE.Return=function(cb){return function(cc){cc.k({$:0,$0:cb});};};bE.scheduler=function(){bS.$cctor();return bS.scheduler;};bE.checkCancel=function(cb){return function(cc){if(cc.ct.c)bE.cancel(cc);else cb(cc);};};bE.defCTS=function(){bS.$cctor();return bS.defCTS;};bE.UncaughtAsyncError=function(cb){b$.log("WebSharper: Uncaught asynchronous exception",cb);};bE.FromContinuations=function(cb){return function(cc){var cd;function ce(cf){if(cd[0])j.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{cd[0]=true;bE.scheduler().Fork(cf);}}cd=[false];cb(function(cf){ce(function(){cc.k({$:0,$0:cf});});},function(cf){ce(function(){cc.k({$:1,$0:cf});});},function(cf){ce(function(){cc.k({$:2,$0:cf});});});};};bE.cancel=function(cb){cb.k({$:2,$0:new b3.New(cb.ct)});};bF.UseAnimations=function(){bJ.$cctor();return bJ.UseAnimations;};bF.Actions=function(cb){return bF.ConcatActions(o.choose(function(cc){return cc.$==1?{$:1,$0:cc.$0}:null;},bK.ToArray(cb.$0)));};bF.Finalize=function(cb){o.iter(function(cc){if(cc.$==0)cc.$0();},bK.ToArray(cb.$0));};bF.ConcatActions=function(cb){var cc,cd,ce,cf;cc=Q.ofSeqNonCopying(cb);cd=o.length(cc);return cd===0?bF.Const():cd===1?o.get(cc,0):(ce=v.max(v.map(function(cg){return cg.Duration;},cc)),(cf=o.map(function(cg){return bF.Prolong(ce,cg);},cc),bF.Def(ce,function(cg){o.iter(function(ch){ch.Compute(cg);},cf);})));};bF.List=function(cb){return cb.$0;};bF.Const=function(cb){return bF.Def(0,function(){return cb;});};bF.Def=function(cb,cc){return{Compute:cc,Duration:cb};};bF.Prolong=function(cb,cc){var cd,ce,cf;cd=cc.Compute;ce=cc.Duration;cf=b4.Create(function(){return cc.Compute(cc.Duration);});return{Compute:function(cg){return cg>=ce?cf.f():cd(cg);},Duration:cb};};bG.$cctor=function(){bG.$cctor=a.ignore;bG.BatchUpdatesEnabled=true;};bH.concat=function(cb){var cc,cd;cc=[];for(var ce in cb)cc.push.apply(cc,cb[ce]);return cc;};bI.$cctor=function(){var cb;bI.$cctor=a.ignore;bI.rxhtmlTag=new a.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi");bI.rtagName=new a.RegExp("<([\\w:]+)");bI.rhtml=new a.RegExp("<|&#?\\w+;");bI.wrapMap=(cb=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:cb,tbody:cb,tfoot:cb,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]});bI.defaultWrap=[0,"",""];};bJ.$cctor=function(){bJ.$cctor=a.ignore;bJ.CubicInOut=bQ.Custom(function(cb){var cc;cc=cb*cb;return 3*cc-2*(cc*cb);});bJ.UseAnimations=true;};bK.Append=function(cb,cc){return cb.$==0?cc:cc.$==0?cb:{$:2,$0:cb,$1:cc};};bK.ToArray=function(cb){var cc;function cd(ce){var cf,cg;while(true)if(ce.$==1)return cc.push(ce.$0);else if(ce.$==2){cf=ce.$1;cg=ce.$0;cd(cg);ce=cf;}else return ce.$==3?o.iter(function(ch){cc.push(ch);},ce.$0):null;}cc=[];cd(cb);return cc.slice(0);};bK.Concat=function(cb){var cc;cc=Q.ofSeqNonCopying(cb);return Q.TreeReduce(bK.Empty(),bK.Append,cc);};bK.Empty=function(){b5.$cctor();return b5.Empty;};bL=f.DynamicAttrNode=b_.Class({NChanged:function(){return this.updates;},NGetExitAnim:function(cb){return bn.get_Empty();},NGetEnterAnim:function(cb){return bn.get_Empty();},NGetChangeAnim:function(cb){return bn.get_Empty();},NSync:function(cb){if(this.dirty){(this.push(cb))(this.value);this.dirty=false;}}},e,bL);bL.New=b_.Ctor(function(cb,cc){var cd;cd=this;e.New.call(this);this.push=cc;this.value=void 0;this.dirty=false;this.updates=V.Map(function(ce){cd.value=ce;cd.dirty=true;},cb);},bL);bN=d.KeyNotFoundException=b_.Class({},bM,bN);bN.New=b_.Ctor(function(){bN.New$1.call(this,"The given key was not present in the dictionary.");},bN);bN.New$1=b_.Ctor(function(cb){this.message=cb;s.setPrototypeOf(this,bN.prototype);},bN);bO.$cctor=function(){var cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co;bO.$cctor=a.ignore;bO.EmptyAttr=null;bO.BoolCheckedApply=function(cp){function cq(cr,cs){return cs!=null&&cs.$==1?void(cr.checked=cs.$0):null;}return[function(cr){cr.addEventListener("change",function(){return cp.Get()!=cr.checked?cp.Set(cr.checked):null;});},function(cr){return function(cs){return cq(cr,cs);};},V.Map(function(cr){return{$:1,$0:cr};},cp.get_View())];};bO.StringSet=function(cp){return function(cq){cp.value=cq;};};bO.StringGet=function(cp){return{$:1,$0:cp.value};};bO.StringApply=(cb=bW.StringGet(),(cc=bW.StringSet(),function(cp){return bW.ApplyValue(cb,cc,cp);}));bO.DateTimeSetUnchecked=function(cp){return function(cq){cp.value=(new b8(cq)).toLocaleString();};};bO.DateTimeGetUnchecked=function(cp){var cq,cr,cs,ct;cq=cp.value;return bX.isBlank(cq)?{$:1,$0:-8640000000000000}:(cr=(cs=0,[(ct=b2.TryParse(cq),ct!=null&&ct.$==1&&(cs=ct.$0,true)),cs]),cr[0]?{$:1,$0:cr[1]}:null);};bO.DateTimeApplyUnchecked=(cd=bW.DateTimeGetUnchecked(),(ce=bW.DateTimeSetUnchecked(),function(cp){return bW.ApplyValue(cd,ce,cp);}));bO.FileSetUnchecked=function(){return function(){return null;};};bO.FileGetUnchecked=function(cp){var cq;cq=cp.files;return{$:1,$0:o.ofSeq(v.delay(function(){return v.map(function(cr){return cq.item(cr);},j.range(0,cq.length-1));}))};};bO.FileApplyUnchecked=(cf=bW.FileGetUnchecked(),(cg=bW.FileSetUnchecked(),function(cp){return bW.FileApplyValue(cf,cg,cp);}));bO.IntSetUnchecked=function(cp){return function(cq){cp.value=b9(cq);};};bO.IntGetUnchecked=function(cp){var cq,cr;cq=cp.value;return bX.isBlank(cq)?{$:1,$0:0}:(cr=+cq,cr!==cr>>0?null:{$:1,$0:cr});};bO.IntApplyUnchecked=(ch=bW.IntGetUnchecked(),(ci=bW.IntSetUnchecked(),function(cp){return bW.ApplyValue(ch,ci,cp);}));bO.IntSetChecked=function(cp){return function(cq){var cr;cr=cq.get_Input();return cp.value!=cr?void(cp.value=cr):null;};};bO.IntGetChecked=function(cp){var cq,cr,cs;cq=cp.value;return{$:1,$0:bX.isBlank(cq)?(cp.checkValidity?cp.checkValidity():true)?new bY({$:2,$0:cq}):new bY({$:1,$0:cq}):(cr=(cs=0,[A.TryParseInt32(cq,{get:function(){return cs;},set:function(ct){cs=ct;}}),cs]),cr[0]?new bY({$:0,$0:cr[1],$1:cq}):new bY({$:1,$0:cq}))};};bO.IntApplyChecked=(cj=bW.IntGetChecked(),(ck=bW.IntSetChecked(),function(cp){return bW.ApplyValue(cj,ck,cp);}));bO.FloatSetUnchecked=function(cp){return function(cq){cp.value=b9(cq);};};bO.FloatGetUnchecked=function(cp){var cq,cr;cq=cp.value;return bX.isBlank(cq)?{$:1,$0:0}:(cr=+cq,a.isNaN(cr)?null:{$:1,$0:cr});};bO.FloatApplyUnchecked=(cl=bW.FloatGetUnchecked(),(cm=bW.FloatSetUnchecked(),function(cp){return bW.ApplyValue(cl,cm,cp);}));bO.FloatSetChecked=function(cp){return function(cq){var cr;cr=cq.get_Input();return cp.value!=cr?void(cp.value=cr):null;};};bO.FloatGetChecked=function(cp){var cq,cr;cq=cp.value;return{$:1,$0:bX.isBlank(cq)?(cp.checkValidity?cp.checkValidity():true)?new bY({$:2,$0:cq}):new bY({$:1,$0:cq}):(cr=+cq,a.isNaN(cr)?new bY({$:1,$0:cq}):new bY({$:0,$0:cr,$1:cq}))};};bO.FloatApplyChecked=(cn=bW.FloatGetChecked(),(co=bW.FloatSetChecked(),function(cp){return bW.ApplyValue(cn,co,cp);}));};bP=bE.Scheduler=b_.Class({Fork:function(cb){var cc;cc=this;this.robin.push(cb);if(this.idle){this.idle=false;a.setTimeout(function(){cc.tick();},0);}},tick:function(){var cb,cc,cd;cc=this;cd=b8.now();cb=true;while(cb)if(this.robin.length===0){this.idle=true;cb=false;}else{(this.robin.shift())();b8.now()-cd>40?(a.setTimeout(function(){cc.tick();},0),cb=false):void 0;}}},e,bP);bP.New=b_.Ctor(function(){e.New.call(this);this.idle=true;this.robin=[];},bP);bQ=f.Easing=b_.Class({},e,bQ);bQ.Custom=function(cb){return new bQ.New(cb);};bQ.New=b_.Ctor(function(cb){e.New.call(this);this.transformTime=cb;},bQ);bR.New=function(cb,cc){return{k:cb,ct:cc};};bS.$cctor=function(){bS.$cctor=a.ignore;bS.noneCT=bT.New(false,[]);bS.scheduler=new bP.New();bS.defCTS=[new bZ.New()];bS.Zero=bE.Return();bS.GetCT=function(cb){cb.k({$:0,$0:cb.ct});};};bT.New=function(cb,cc){return{c:cb,r:cc};};bU.Filter=function(cb,cc){return new _1.New$2(o.filter(cb,bU.ToArray(cc)));};bU.Except=function(cb,cc){var cd;cd=new _1.New$2(bU.ToArray(cc));cd.ExceptWith(bU.ToArray(cb));return cd;};bU.ToArray=function(cb){var cc;cc=o.create(cb.Count(),void 0);cb.CopyTo(cc,0);return cc;};bU.Intersect=function(cb,cc){var cd;cd=new _1.New$2(bU.ToArray(cb));cd.IntersectWith(bU.ToArray(cc));return cd;};bV.Clear=function(cb){cb.splice(0,o.length(cb));};bW.ApplyValue=function(cb,cc,cd){var ce;function cf(cg,ch){return ch==null?null:cg(ch.$0);}ce=null;return[function(cg){function ch(){cd.UpdateMaybe(function(ci){var cj;ce=cb(cg);return ce!=null&&ce.$==1&&(!t.Equals(ce.$0,ci)&&(cj=[ce,ce.$0],true))?cj[0]:null;});}cg.addEventListener("change",ch);cg.addEventListener("input",ch);cg.addEventListener("keypress",ch);},function(cg){var ch;ch=cc(cg);return function(ci){return cf(ch,ci);};},V.Map(function(cg){var ch;return ce!=null&&ce.$==1&&(t.Equals(ce.$0,cg)&&(ch=ce.$0,true))?null:{$:1,$0:cg};},cd.get_View())];};bW.StringSet=function(){bO.$cctor();return bO.StringSet;};bW.StringGet=function(){bO.$cctor();return bO.StringGet;};bW.DateTimeSetUnchecked=function(){bO.$cctor();return bO.DateTimeSetUnchecked;};bW.DateTimeGetUnchecked=function(){bO.$cctor();return bO.DateTimeGetUnchecked;};bW.FileApplyValue=function(cb,cc,cd){var ce;function cf(cg,ch){return ch==null?null:cg(ch.$0);}ce=null;return[function(cg){cg.addEventListener("change",function(){cd.UpdateMaybe(function(ch){var ci;ce=cb(cg);return ce!=null&&ce.$==1&&(ce.$0!==ch&&(ci=[ce,ce.$0],true))?ci[0]:null;});});},function(cg){var ch;ch=cc(cg);return function(ci){return cf(ch,ci);};},V.Map(function(cg){var ch;return ce!=null&&ce.$==1&&(t.Equals(ce.$0,cg)&&(ch=ce.$0,true))?null:{$:1,$0:cg};},cd.get_View())];};bW.FileSetUnchecked=function(){bO.$cctor();return bO.FileSetUnchecked;};bW.FileGetUnchecked=function(){bO.$cctor();return bO.FileGetUnchecked;};bW.IntSetUnchecked=function(){bO.$cctor();return bO.IntSetUnchecked;};bW.IntGetUnchecked=function(){bO.$cctor();return bO.IntGetUnchecked;};bW.IntSetChecked=function(){bO.$cctor();return bO.IntSetChecked;};bW.IntGetChecked=function(){bO.$cctor();return bO.IntGetChecked;};bW.FloatSetUnchecked=function(){bO.$cctor();return bO.FloatSetUnchecked;};bW.FloatGetUnchecked=function(){bO.$cctor();return bO.FloatGetUnchecked;};bW.FloatSetChecked=function(){bO.$cctor();return bO.FloatSetChecked;};bW.FloatGetChecked=function(){bO.$cctor();return bO.FloatGetChecked;};bW.StringApply=function(){bO.$cctor();return bO.StringApply;};bW.IntApplyUnchecked=function(){bO.$cctor();return bO.IntApplyUnchecked;};bW.FloatApplyUnchecked=function(){bO.$cctor();return bO.FloatApplyUnchecked;};bW.BoolCheckedApply=function(){bO.$cctor();return bO.BoolCheckedApply;};bW.DateTimeApplyUnchecked=function(){bO.$cctor();return bO.DateTimeApplyUnchecked;};bW.FileApplyUnchecked=function(){bO.$cctor();return bO.FileApplyUnchecked;};bX.isBlank=function(cb){return L.forall(b1.IsWhiteSpace,cb);};bY=f.CheckedInput=b_.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,bY);bZ=d.CancellationTokenSource=b_.Class({},e,bZ);bZ.New=b_.Ctor(function(){e.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bZ);b0.Children=function(cb,cc){var cd,ce,cf;if(cc!=null&&cc.$==1){cf=[];cd=cc.$0[0].nextSibling;while(cd!==cc.$0[1]){cf.push(cd);cd=cd.nextSibling;}return{$:0,$0:cf};}else return{$:0,$0:o.init(cb.childNodes.length,(ce=cb.childNodes,function(cg){return ce[cg];}))};};b0.Except=function(cb,cc){var cd;cd=cb.$0;return{$:0,$0:o.filter(function(ce){return o.forall(function(cf){return!(ce===cf);},cd);},cc.$0)};};b0.Iter=function(cb,cc){o.iter(cb,cc.$0);};b0.DocChildren=function(cb){var cc;function cd(ce){var cf,cg,ch,ci;while(true){if(ce!=null&&ce.$==2){cg=ce.$0;ce=cg.Current;}else if(ce!=null&&ce.$==1)return cc.push(ce.$0.El);else if(ce==null)return null;else if(ce!=null&&ce.$==5)return cc.push(ce.$0);else if(ce!=null&&ce.$==4)return cc.push(ce.$0.Text);else if(ce!=null&&ce.$==6){cf=ce.$0.Els;return(function(cj){return function(ck){o.iter(cj,ck);};}(function(cj){if(cj==null||cj.constructor===s)cd(cj);else cc.push(cj);}))(cf);}else{ch=ce.$1;ci=ce.$0;cd(ci);ce=ch;}}}cc=[];cd(cb.Children);return{$:0,$0:Q.ofSeqNonCopying(cc)};};b1.IsWhiteSpace=function(cb){return cb.match(new a.RegExp("\\s"))!==null;};b2.TryParse=function(cb){var cc;cc=b8.parse(cb);return a.isNaN(cc)?null:{$:1,$0:cc};};A.TryParse=function(cb,cc,cd,ce){var cf,cg;cf=+cb;cg=cf===cf-cf%1&&cf>=cc&&cf<=cd;if(cg)ce.set(cf);return cg;};b3=d.OperationCanceledException=b_.Class({},bM,b3);b3.New=b_.Ctor(function(cb){b3.New$1.call(this,"The operation was canceled.",null,cb);},b3);b3.New$1=b_.Ctor(function(cb,cc,cd){this.message=cb;this.inner=cc;s.setPrototypeOf(this,b3.prototype);this.ct=cd;},b3);b4.Create=function(cb){return b7.New(false,cb,b4.forceLazy);};b4.forceLazy=function(){var cb;cb=this.v();this.c=true;this.v=cb;this.f=b4.cachedLazy;return cb;};b4.cachedLazy=function(){return this.v;};b5.$cctor=function(){b5.$cctor=a.ignore;b5.Empty={$:0};};b7.New=function(cb,cc,cd){return{c:cb,v:cc,f:cd};};b_.OnLoad(function(){c.Main();});}(self));


if (typeof WebSharper !=='undefined') {
  WebSharper.Runtime.ScriptBasePath = '/Content/';
  WebSharper.Runtime.Start();
}
